(function(a){const m=(new window.StecHelper).lang;a(function(){window.stecSharer=function(l,e,c,g,f,k){this.$instance=l;this.glob=e;this.$share=null;this.url=g;this.id=f;this.repeatOffset=k;this.init=function(){var b=this;a(".stec-share").not(".stec-share-template").remove();this.$share=a(e.template.share).appendTo("body");this.$share.removeClass("stec-share-template");this.$share.find("input[name=stec_permalink]").val(g);this.getEmbed(f,this.$share.find("input[name=stec_embed_width]").val(),function(a){b.$share.find("textarea[name=stec_embed]").text(a)});
this.open();this.controller()};this.open=function(){a("body").addClass("stec-modal-opened");a(".stec-layout-event-inner-out-wrapper").hide()};this.close=function(){this.$share.remove();0>=a("body > .stec-modal").length&&a("body").removeClass("stec-modal-opened");a(".stec-layout-event-inner-out-wrapper").show()};this.getEmbed=function(b,h,c){var d=0,e=h?h:400,f="",g=a('<iframe src="'+window.resturl+"stec/v2/get/embed/"+b+"/"+k+'" width="'+e+'" frameborder=0></iframe>').css({position:"fixed",left:-9999,
visibility:"hidden"}).appendTo("body");g.on("load",function(){d=a(this).contents().outerHeight(!0)+15;g.remove();f='<iframe src="'+window.resturl+"stec/v2/get/embed/"+b+"/"+k+'" height="'+d+'" width="'+e+'" frameborder=0></iframe>';c(f)})};this.controller=function(){var b=this;this.$share.on(c.clickHandle(),function(){b.close()});this.$share.find(".stec-share-close").on(c.clickHandle(),function(){b.close()});this.$share.find(".stec-share-block").on(c.clickHandle(),function(a){a.stopPropagation()});
this.$share.find("input[name=stec_embed_width]").on("change",function(){b.getEmbed(f,a(this).val(),function(a){b.$share.find("textarea[name=stec_embed]").text(a)})});this.$share.find("button[data-copy-permalink]").on(c.clickHandle(),function(){var h=b.$share.find("input[name=stec_permalink]").val(),d=a("<input>");a("body").append(d);d.val(h).select();document.execCommand("copy");d.remove();c.toast(m("copiedToClipboard"),b.$share)});this.$share.find("button[data-copy-embed]").on(c.clickHandle(),function(){var h=
b.$share.find("textarea[name=stec_embed]").text(),d=a("<input>");a("body").append(d);d.val(h).select();document.execCommand("copy");d.remove();c.toast(m("copiedToClipboard"),b.$share)})}};window.stecEmailEvent=function(l,e,c,g,f,k){this.$instance=l;this.glob=e;this.$emailForm=null;this.url=g;this.id=f;this.repeatOffset=k;this.init=function(){a(".stec-email-event").not(".stec-email-event-template").remove();this.$emailForm=a(e.template.emailEvent).appendTo("body");this.$emailForm.removeClass("stec-email-event-template");
this.open();this.controller()};this.open=function(){a("body").addClass("stec-modal-opened");a(".stec-layout-event-inner-out-wrapper").hide()};this.close=function(){this.$emailForm.remove();0>=a("body > .stec-modal").length&&a("body").removeClass("stec-modal-opened");a(".stec-layout-event-inner-out-wrapper").show()};this.controller=function(){var b=this;this.$emailForm.on(c.clickHandle(),function(){b.close()});this.$emailForm.find(".stec-email-event-close").on(c.clickHandle(),function(){b.close()});
this.$emailForm.find(".stec-email-event-block").on(c.clickHandle(),function(a){a.stopPropagation()});this.$emailForm.find(".stec-email-event-compose").on(c.clickHandle(),function(c){c=b.$emailForm.find('input[name="stec_email"]').val();var d=b.$emailForm.find('textarea[name="stec_message"]').val();d+="\n\n"+b.url;a(this).attr("href","mailto:"+encodeURIComponent(c)+"?body="+encodeURIComponent(d))})}}})})(window.jQuery);