(function(f){function B(){const k=(new window.StecHelper).lang;var u=this,p=window.moment,x="",c="",b={options:{date:{day:1,month:1,year:2021},set day(a){this.date.day=parseInt(a,10);c.find(".stec-event-submission-form").trigger("stec-day-change",this.date)},set month(a){this.date.month=parseInt(a,10)},set year(a){this.date.year=parseInt(a,10)},get day(){return this.date.day},get month(){return this.date.month},get year(){return this.date.year},monthLabelsShort:[k("jan"),k("feb"),k("mar"),k("apr"),
k("may"),k("jun"),k("jul"),k("aug"),k("sep"),k("oct"),k("nov"),k("dec")],monthLabels:[k("january"),k("february"),k("march"),k("april"),k("may"),k("june"),k("july"),k("august"),k("september"),k("october"),k("november"),k("december")],dayLabels:[k("sunday"),k("monday"),k("tuesday"),k("wednesday"),k("thursday"),k("friday"),k("saturday")],dayLabelsShort:[k("sun"),k("mon"),k("tue"),k("wed"),k("thu"),k("fri"),k("sat")],myLocation:""},template:{eventCreateForm:"",event:"",gridevent:"",boxgridevent:"",eventInner:"",
tooltip:"",preloader:"",share:"",emailEvent:""},temp:[],blockAction:!1,ajax:null,timeout:[]},g,r,B,D,C,E,F,G={add:function(){f("#stec-init-preloader-"+b.options.id).show()},count:function(a){f("#stec-init-preloader-"+b.options.id).find(".stec-init-preloader-count").text(a)},destroy:function(){f("#stec-init-preloader-"+b.options.id).remove()}},v={init:function(){this.bindControls()},bindControls:function(){var a=this;f(document).on(g.clickHandle(),c.$events.path+" a",function(a){a.stopPropagation();
return!0});f(document).on(g.clickHandle(),c.$events.path+".stec-layout-event-preview-right-event-toggle:not('.stec-layout-event-create-form-preview-right-event-toggle')",function(d){d.preventDefault();d.stopPropagation();d=f(this).parents(".stec-layout-event");a.eventToggle(d)});f(document).on(g.clickHandle(),c.$events.path+".stec-layout-event:not('.stec-event-create-form, .stec-layout-event-awaiting-approval')",function(d){d.preventDefault();d=f(this);a.eventToggle(d)});f(document).on(g.clickHandle(),
c.$events.path+".stec-layout-event-inner",function(a){a.stopPropagation()});f(document).on(g.clickHandle(),c.$events.path+".stec-layout-event-inner-top-tabs li",function(d){d.preventDefault();a.activateTab(f(this))});f(document).on(g.clickHandle(),"#stec-layout-event-inner-"+b.options.id+" .stec-layout-event-inner-top-tabs li",function(d){d.preventDefault();a.activateTab(f(this))});f(document).on(g.clickHandle(),"#stec-layout-event-inner-"+b.options.id+" .stec-layout-event-inner-close",function(a){a.preventDefault();
f(this).parents(".stec-layout-event-inner-out-wrapper").remove();f("body").removeClass("stec-modal-opened stec-no-scroll")});f(document).on(g.clickHandle(),"#stec-layout-event-inner-"+b.options.id,function(a){a.stopPropagation()});f(document).on(g.clickHandle(),"#stec-layout-event-inner-out-wrapper-"+b.options.id,function(a){a.preventDefault();f(this).remove();f("body").removeClass("stec-modal-opened stec-no-scroll");c.trigger("onEventToggleClose")})},setEventTabs:function(a){var d=r.getEventById(a.attr("data-id")),
c=0,h=8<a.find(".stec-layout-event-inner-top-tabs-content > div").length?!0:!1;0===parseInt(d.comments,10)?a.find('.stec-layout-event-inner-top-tabs [data-tab="stec-layout-event-inner-comments"]').remove():c++;d.location.full_address?c++:a.find('.stec-layout-event-inner-top-tabs [data-tab="stec-layout-event-inner-location"]').remove();d.location.coordinates&&b.options.general_settings.weather_api_key?c++:a.find('.stec-layout-event-inner-top-tabs [data-tab="stec-layout-event-inner-forecast"]').remove();
0>=d.schedule.length?a.find('.stec-layout-event-inner-top-tabs [data-tab="stec-layout-event-inner-schedule"]').remove():c++;0>=d.guests.length?a.find('.stec-layout-event-inner-top-tabs [data-tab="stec-layout-event-inner-guests"]').remove():c++;0>=d.attendance.length?a.find('.stec-layout-event-inner-top-tabs [data-tab="stec-layout-event-inner-attendance"]').remove():c++;0>=d.products.length?a.find('.stec-layout-event-inner-top-tabs [data-tab="stec-layout-event-inner-shop"]').remove():c++;1>c&&!1===
h&&a.find(".stec-layout-event-inner-top-tabs").hide()},eventToggle:function(a){var d="_blank";b.options.general_settings.event_open_target&&(d=b.options.general_settings.event_open_target);switch(b.options.general_settings.open_event_in){case "single":return window.open(a.data("permalink"),d),!1;case "external":a=a.attr("data-id");var e=r.getEventById(a);if(a=e.link.url)return window.open(a,d),!1;break;case "modal":0>=a.find(".stec-layout-event-inner").length&&f(b.template.eventInner).addClass("stec-modal").appendTo(a);
this.setEventTabs(a);e=r.getEventById(a.attr("data-id"));d=a.find(".stec-modal").appendTo("body");d.attr("id","stec-layout-event-inner-"+b.options.id);d.data("event-id",a.attr("data-id"));d.data("repeat-time-offset",a.attr("data-repeat-time-offset"));d.wrap('<div id="stec-layout-event-inner-out-wrapper-'+b.options.id+'" class="stec-layout-event-inner-out-wrapper stec-modal"></div>');f('<i class="stec-layout-event-inner-close fa fa-times"></i>').appendTo(d);0>=d.find(".stec-layout-event-inner-top-tabs").children("li.active").length&&
d.find(".stec-layout-event-inner-top-tabs").children("li").first().trigger(g.clickHandle());f(window).trigger("stec-trigger-resize");f("body").addClass("stec-modal-opened stec-no-scroll");d.show();g.focus(d);c.trigger("onEventToggleOpen",{$instance:c,$container:d,event:e,glob:b,helper:g,repeatOffset:a.attr("data-repeat-time-offset")});break;default:a.hasClass("active")?(a.removeClass("active").find(".stec-layout-event-preview-right-event-toggle").removeClass("active"),c.trigger("onEventToggleClose")):
(0>=a.find(".stec-layout-event-inner").length&&f(b.template.eventInner).appendTo(a),a.addClass("active").find(".stec-layout-event-preview-right-event-toggle").addClass("active"),e=c.$events.find(".stec-layout-event").not(a),e.removeClass("active").find(".stec-layout-event-preview-right-event-toggle").removeClass("active"),this.setEventTabs(a),0>=a.find(".stec-layout-event-inner-top-tabs").children("li.active").length&&a.find(".stec-layout-event-inner-top-tabs").children("li").first().trigger(g.clickHandle()),
e=r.getEventById(a.attr("data-id")),d=a.find(".stec-layout-event-inner"),d.data("event-id",a.attr("data-id")),d.data("repeat-time-offset",a.attr("data-repeat-time-offset")),c.trigger("onEventToggleOpen",{$instance:c,$container:d,event:e,glob:b,helper:g,repeatOffset:a.attr("data-repeat-time-offset")}),g.focus(a))}},activateTab:function(a){if(!a.hasClass("active")){a.addClass("active").siblings().removeClass("active");a.parents(".stec-layout-event-inner").find(".stec-layout-event-inner-top-tabs-content").children(".active").removeClass("active");
var d="."+a.attr("data-tab");a.parents(".stec-layout-event-inner").find(d).addClass("active");f(document).trigger("stec-tab-click-"+b.options.id)}},eventHolder:{getEventHolder:function(){var a="";switch(b.options.view){case "agenda":a=c.$agenda.find(".stec-event-holder");break;case "month":a=c.$month.find(".stec-event-holder");break;case "week":a=c.$week.find(".stec-event-holder");break;case "day":a=c.$day.find(".stec-event-holder");break;case "map":a=c.$map.find(".stec-event-holder")}return a},removeEvents:function(){f(document).unbind("stec-tab-click-"+
b.options.id);f(window).unbind("resize.stec-unbind-window-resize-on-event-close-"+b.options.id);c.$events.not(".stec-layout-agenda-events-all").children().remove()},displayEvents:function(a){var d=g.newDate(b.options.year,b.options.month,b.options.day);a=a?a:r.getEvents(d,!1);if(0>=a.length)return!1;f(a).each(function(){var a=this,d=[],n=[];(0<g.getEventState(this)||"EventCancelled"===a.event_status||"0"===b.options.general_settings.reminder)&&d.push("stec-layout-event-no-reminder");var t=g.beautifyTimespan(a.start_date,
1===parseInt(a.hide_end,10)?!1:a.end_date,a.all_day);var l=parseInt(a.timezone_utc_offset,10)/3600;l=0<l?"+"+l:l;0===l&&(l="");var H=0===parseInt(b.options.general_settings.date_label_gmtutc,10)?"":"UTC/GMT "+l;switch(parseInt(this.featured,10)){case 1:d.push("stec-event-featured");break;case 2:d.push("stec-event-featured stec-event-featured-bg")}"EventCancelled"===a.event_status&&d.push("stec-event-cancelled");"icon"!==a.icon_type||a.icon&&"fa"!==a.icon||d.push("stec-no-icon");a.edit_link||d.push("stec-no-edit");
(a.description_short&&"1"===b.options.general_settings.preview_desc||a.location.full_address&&"1"===b.options.general_settings.preview_location)&&d.push("stec-layout-event-preview-size-big");switch(a.icon_type){case "image":0<a.icon_images.length?(n.push('<div class="stec-layout-event-preview-left-icon-images">'),f.each(a.icon_images_meta,function(a){n.push('<div class="stec-layout-event-preview-left-icon-image '+(0===a?"active":"")+'" style="background-image: url('+this.src+')"></div>')}),n.push("</div>")):
n.push('<i class="'+a.icon+'"></i>');break;case "date":l=p(a.start_date);n.push('<span class="stec-layout-event-preview-left-icon-date"><span class="stec-layout-event-preview-left-icon-date-number">'+l.format("D")+'</span><span class="stec-layout-event-preview-left-icon-date-month">'+k(l.format("MMM").toLowerCase())+"</span></span>");break;default:n.push('<i class="'+a.icon+'"></i>')}f(b.template.event).addClass(d.join(" ")).attr("data-id",a.id).attr("data-repeat-time-offset",a.repeat_time_offset?
a.repeat_time_offset:0).data("permalink",g.getPermalink(a.permalink,a.repeat_time_offset)).html(function(d,h){d=f(h);h=[];a.location.full_address&&"1"===b.options.general_settings.preview_location||d.find(".stec-layout-event-preview-left-text-location").remove();a.description_short&&"1"===b.options.general_settings.preview_desc||d.find(".stec-layout-event-preview-left-text-desc").remove();b.temp.EventPreviewHtml=d.get(0).outerHTML;c.trigger("stecBeforeReturnEventPreviewHtml",{$instance:c,event:a,
temp:b.temp});switch(a.event_status){case "EventCancelled":h.push('<p class="stec-layout-event-preview-left-text-event-status"><span class="cancelled">'+k("Cancelled")+"</span></p>");break;case "EventMovedOnline":h.push('<p class="stec-layout-event-preview-left-text-event-status"><span class="moved-online">'+k("Moved Online")+"</span></p>");break;case "EventPostponed":h.push('<p class="stec-layout-event-preview-left-text-event-status"><span class="postponed">'+k("Postponed")+"</span></p>");break;
case "EventRescheduled":h.push('<p class="stec-layout-event-preview-left-text-event-status"><span class="rescheduled">'+k("Rescheduled")+"</span></p>");break;default:h=[]}0===a.approved&&h.push('<p class="stec-layout-event-preview-left-text-event-status"><span class="unapproved">'+k("Awaiting Approval")+"</span></p>");return b.temp.EventPreviewHtml.replace("stec_replace_event_status",h.join("")).replace("stec_replace_summary",a.title).replace("stec_replace_location",function(){return"virtual"===a.location.type?
k("Online Event"):a.location.title?[a.location.title,a.location.full_address].join(", "):a.location.full_address}).replace("stec_replace_desc_short",a.description_short).replace("stec_replace_date",t+" "+H).replace('stec_replace_event_background=""',' style="background:'+a.color+'" ').replace("stec_replace_icon",n.join("")).replace(/#stec_replace_edit_link/g,a.edit_link)}).appendTo(c.$events.not(".stec-layout-agenda-events-all"))});switch(b.options.general_settings.open_event_in){case "single":case "external":case "modal":c.$events.not(".stec-layout-agenda-events-all").find(".stec-layout-event-preview-right-event-toggle").remove()}return!0},
close:function(){c.$events.not(".stec-layout-agenda-events-all").find(".active").removeClass("active");this.getEventHolder().hide();"month"===b.options.view&&c.$month.find(".stec-layout-month-weekrow").last().addClass("stec-layout-month-weekrow-last");"week"===b.options.view&&c.$week.find(".stec-layout-week-weekrow").addClass("stec-layout-week-weekrow-last");g.extendBind("stachethemes_ec_extend","onEventHolderClose");this.removeEvents()},open:function(){this.close();var a=this.displayEvents();"day"===
b.options.view&&(!1===a?c.$day.find(".stec-layout-day-noevents").show():c.$day.find(".stec-layout-day-noevents").hide());if(!1!==a||0!==parseInt(b.options.general_settings.show_create_event_form,10))"month"===b.options.view&&(c.$month.find(".stec-layout-month-eventholder").is(":last-child")?c.$month.find(".stec-layout-month-weekrow-last").removeClass("stec-layout-month-weekrow-last"):c.$month.find("tr").last().addClass("stec-layout-month-weekrow-last"),g.focus(c.$month.find(".stec-layout-month-daycell.active"))),
"week"===b.options.view&&c.$week.find(".stec-layout-week-weekrow-last").removeClass("stec-layout-week-weekrow-last"),g.extendBind("stachethemes_ec_extend","onEventHolderOpen"),g.animate.eventHolder.open(this.getEventHolder())},openEvents:function(a,d,e){this.close();a=this.displayEvents(a);"day"===b.options.view&&(!1===a?c.$day.find(".stec-layout-day-noevents").show():c.$day.find(".stec-layout-day-noevents").hide());if(!1!==a||0!==parseInt(b.options.general_settings.show_create_event_form,10))"month"===
b.options.view&&(c.$month.find(".stec-layout-month-eventholder").is(":last-child")?c.$month.find(".stec-layout-month-weekrow-last").removeClass("stec-layout-month-weekrow-last"):c.$month.find("tr").last().addClass("stec-layout-month-weekrow-last"),g.focus(c.$month.find(".stec-layout-month-daycell.active"))),"week"===b.options.view&&c.$week.find(".stec-layout-week-weekrow-last").removeClass("stec-layout-week-weekrow-last"),g.extendBind("stachethemes_ec_extend","onEventHolderOpen"),g.animate.eventHolder.open(this.getEventHolder(),
d,e)}}},y={dropDownScrollSpeed:1E3,init:function(){this.bindControls();this.bindMobile();2===parseInt(b.options.general_settings.show_calfilter,10)&&this.setStaticFilterMenu();0>=c.$top.find(".stec-top-menu").children().length&&c.$top.find(".stec-top-menu").remove()},setStaticFilterMenu:function(){var a=c.$top.find(".stec-top-menu-filter"),d=c.$top.find(".stec-top-menu-filter-dropdown");a.remove();d.addClass("active static")},bindMobile:function(){g.isMobile()&&(f(document).on(g.clickHandle(),function(){c.$top.find(".mobile-hover").removeClass("mobile-hover")}),
c.$top.find(".stec-top-dropmenu-layouts").children("li").on(g.clickHandle(),function(a){a.preventDefault();a.stopPropagation();f(this).toggleClass("mobile-hover");c.find(".stec-top-menu-filter").removeClass("active");c.find(".stec-top-menu-filter-dropdown:not(.static)").removeClass("active");c.find(".stec-top-menu-filter-dropdown").children(".stec-style-flexbox").children().removeClass("active");c.find(".stec-top-menu-filter-dropdown > div > div").find("> div > i:last-child").removeClass("fa-chevron-down").addClass("fa-chevron-right")}),
c.$top.find(".stec-top-menu-date").children("li").on(g.clickHandle(),function(a){var d=[];a.preventDefault();f(this).toggleClass("mobile-hover");if(f(this).hasClass("mobile-hover")){a.stopPropagation();if(f(this).hasClass("stec-top-menu-date-day")){f(this).prop("hovering",!0);f(this).find(".stec-top-menu-date-dropdown ul").remove();var c=b.options.day;d.push("<ul>");var h=g.getMonthInfo();h=h.monthLength;for(a=0;3>a;a++)c=1>c-1?h:c-1;for(a=0;5>a;a++)c=c+1>h?1:c+1,d.push('<li><p data-day="'+c+'">'+
c+"</p></li>");d.push("</ul>");f(this).find(".stec-top-menu-date-control-up").after(d.join(""));y.dateDropdownSetActive()}if(f(this).hasClass("stec-top-menu-date-week")){f(this).find(".stec-top-menu-date-dropdown ul").remove();c=g.newDate(b.options.year,b.options.month,b.options.day);c.setDate(c.getDate()-21);switch(b.options.general_settings.date_format){case "dd.mm.yyyy":var n="sday. smonth - eday. emonth. eyear";break;case "dd-mm-yy":n="sday smonth - eday emonth eyear";break;case "mm-dd-yy":n=
"smonth sday - emonth eday eyear";break;default:n="smonth sday - eyear emonth eday"}d.push("<ul>");for(a=0;5>a;a++){c.setDate(c.getDate()+7);h=g.getWeekInfo(c);var t=g.getWeekLabel(n,h);d.push('<li><p data-week="'+h.week+'" data-date="'+h.start.year+"-"+h.start.month+"-"+h.start.day+'">'+t+"</p></li>")}d.push("</ul>");f(this).find(".stec-top-menu-date-control-up").after(d.join(""));y.dateDropdownSetActive()}if(f(this).hasClass("stec-top-menu-date-month")){f(this).find(".stec-top-menu-date-dropdown ul").remove();
h=b.options.month;for(a=0;3>a;a++)h=0>h-1?11:h-1;d.push("<ul>");for(a=0;5>a;a++)h=11<h+1?0:h+1,d.push('<li><p data-month="'+h+'">'+b.options.monthLabels[h]+"</p></li>");d.push("</ul>");f(this).find(".stec-top-menu-date-control-up").after(d.join(""));y.dateDropdownSetActive()}if(f(this).hasClass("stec-top-menu-date-year")){f(this).find(".stec-top-menu-date-dropdown ul").remove();c=b.options.year;d.push("<ul>");c-=3;for(a=0;5>a;a++)c++,d.push('<li><p data-year="'+c+'">'+c+"</p></li>");d.push("</ul>");
f(this).find(".stec-top-menu-date-control-up").after(d.join(""));y.dateDropdownSetActive()}}}),c.$top.find(".stec-top-menu-date-control-up, .stec-top-menu-date-control-down").on(g.clickHandle(),function(a){a.stopPropagation()}))},bindControls:function(){var a=this;f(document).on(g.clickHandle(),function(){c.find(".stec-top-menu-filter").removeClass("active");c.find(".stec-top-menu-filter-dropdown:not(.static)").removeClass("active");c.find(".stec-top-menu-search").removeClass("active")});c.$top.find("[data-view]").on(g.clickHandle(),
function(){b.options.view=f(this).attr("data-view");u.refreshState("layout")});0<c.$top.find(".stec-top-menu-date-year").length&&c.$top.find(".stec-top-menu-date-year").get(0).addEventListener("wheel",function(d){d.preventDefault();0<d.wheelDelta||0>d.detail?a.dateYearScrollUp():a.dateYearScrollDown()},{passive:!1});0<c.$top.find(".stec-top-menu-date-month").length&&c.$top.find(".stec-top-menu-date-month").get(0).addEventListener("wheel",function(d){d.preventDefault();0<d.wheelDelta||0>d.detail?a.dateMonthScrollUp():
a.dateMonthScrollDown()},{passive:!1});0<c.$top.find(".stec-top-menu-date-week").length&&c.$top.find(".stec-top-menu-date-week").get(0).addEventListener("wheel",function(d){d.preventDefault();0<d.wheelDelta||0>d.detail?a.dateWeekScrollUp():a.dateWeekScrollDown()},{passive:!1});0<c.$top.find(".stec-top-menu-date-day").length&&c.$top.find(".stec-top-menu-date-day").get(0).addEventListener("wheel",function(d){d.preventDefault();0<d.wheelDelta||0>d.detail?a.dateDayScrollUp():a.dateDayScrollDown()},{passive:!1});
c.$top.find(".stec-top-menu-date-year, .stec-top-menu-date-month, .stec-top-menu-date-week, .stec-top-menu-date-day").on("mouseleave",function(){f(this).prop("hovering",null)});c.$top.find(".stec-top-menu-date-day").on("mouseenter",function(){var a=[],c;if(!f(this).prop("hovering")){f(this).prop("hovering",!0);f(this).find(".stec-top-menu-date-dropdown ul").remove();var h=b.options.day;a.push("<ul>");var n=g.getMonthInfo().monthLength;for(c=0;3>c;c++)h=1>h-1?n:h-1;for(c=0;5>c;c++)h=h+1>n?1:h+1,a.push('<li><p data-day="'+
h+'">'+h+"</p></li>");a.push("</ul>");f(this).find(".stec-top-menu-date-control-up").after(a.join(""));y.dateDropdownSetActive()}});c.$top.find(".stec-top-menu-date-week").on("mouseenter",function(){var a,c,h=[];if(!f(this).prop("hovering")){f(this).prop("hovering",!0);f(this).find(".stec-top-menu-date-dropdown ul").remove();var n=g.newDate(b.options.year,b.options.month,b.options.day);for(a=0;3>a&&!(0>=n.getFullYear());a++)n.setDate(n.getDate()-7);switch(b.options.general_settings.date_format){case "dd.mm.yyyy":a=
"sday. smonth - eday. emonth. eyear";break;case "dd-mm-yy":a="sday smonth - eday emonth eyear";break;case "mm-dd-yy":a="smonth sday - emonth eday eyear";break;default:a="smonth sday - eyear emonth eday"}h.push("<ul>");for(c=0;5>c;c++){n.setDate(n.getDate()+7);var t=g.getWeekInfo(n);var l=g.getWeekLabel(a,t);h.push('<li><p data-week="'+t.week+'" data-date="'+t.start.year+"-"+t.start.month+"-"+t.start.day+'">'+l+"</p></li>")}h.push("</ul>");f(this).find(".stec-top-menu-date-control-up").after(h.join(""));
y.dateDropdownSetActive()}});c.$top.find(".stec-top-menu-date-month").on("mouseenter",function(){var a=[],c;if(!f(this).prop("hovering")){f(this).prop("hovering",!0);f(this).find(".stec-top-menu-date-dropdown ul").remove();var h=b.options.month;for(c=0;3>c;c++)h=0>h-1?11:h-1;a.push("<ul>");for(c=0;5>c;c++)h=11<h+1?0:h+1,a.push('<li><p data-month="'+h+'">'+b.options.monthLabels[h]+"</p></li>");a.push("</ul>");f(this).find(".stec-top-menu-date-control-up").after(a.join(""));y.dateDropdownSetActive()}});
c.$top.find(".stec-top-menu-date-year").on("mouseenter",function(){var a=[],c;if(!f(this).prop("hovering")){f(this).prop("hovering",!0);f(this).find(".stec-top-menu-date-dropdown ul").remove();var h=b.options.year;a.push("<ul>");for(c=0;3>c&&!(0>=h);c++)h--;for(c=0;5>c;c++)h++,a.push('<li><p data-year="'+h+'">'+h+"</p></li>");a.push("</ul>");f(this).find(".stec-top-menu-date-control-up").after(a.join(""));y.dateDropdownSetActive()}});c.$top.find(".stec-top-menu-date-week .stec-top-menu-date-control-up").on(g.clickHandle(),
function(d){d.preventDefault();a.dateWeekScrollUp()});c.$top.find(".stec-top-menu-date-week .stec-top-menu-date-control-down").on(g.clickHandle(),function(d){d.preventDefault();a.dateWeekScrollDown()});c.$top.find(".stec-top-menu-date-year .stec-top-menu-date-control-up").on(g.clickHandle(),function(d){d.preventDefault();a.dateYearScrollUp()});c.$top.find(".stec-top-menu-date-year .stec-top-menu-date-control-down").on(g.clickHandle(),function(d){d.preventDefault();a.dateYearScrollDown()});c.$top.find(".stec-top-menu-date-month .stec-top-menu-date-control-up").on(g.clickHandle(),
function(d){d.preventDefault();a.dateMonthScrollUp()});c.$top.find(".stec-top-menu-date-month .stec-top-menu-date-control-down").on(g.clickHandle(),function(d){d.preventDefault();a.dateMonthScrollDown()});c.$top.find(".stec-top-menu-date-day .stec-top-menu-date-control-up").on(g.clickHandle(),function(d){d.preventDefault();a.dateDayScrollUp()});c.$top.find(".stec-top-menu-date-day .stec-top-menu-date-control-down").on(g.clickHandle(),function(d){d.preventDefault();a.dateDayScrollDown()});f(document).on(g.clickHandle(),
c.$top.path+".stec-top-menu-date-month ul li",function(a){a.preventDefault();a=f(this).find("[data-month]").attr("data-month");b.options.month=parseInt(a,10);a=g.getMonthInfo();b.options.day>a.monthLength&&(b.options.day=parseInt(a.monthLength,10));u.refreshState("layout")});f(document).on(g.clickHandle(),c.$top.path+".stec-top-menu-date-year ul li",function(a){a.preventDefault();a=f(this).find("[data-year]").attr("data-year");b.options.year=parseInt(a,10);u.refreshState("layout")});f(document).on(g.clickHandle(),
c.$top.path+".stec-top-menu-date-week ul li",function(a){a.preventDefault();a=g.getDateFromData(f(this).find("[data-date]").attr("data-date"));b.options.year=a.getFullYear();b.options.month=a.getMonth();b.options.day=a.getDate();u.refreshState("layout")});f(document).on(g.clickHandle(),c.$top.path+".stec-top-menu-date-day ul li",function(a){a.preventDefault();b.options.day=parseInt(f(this).find("[data-day]").attr("data-day"),10);u.refreshState("layout")});c.$top.find("[data-action='previous']").on(g.clickHandle(),
function(a){a.preventDefault();switch(b.options.view){case "boxgrid":case "grid":case "agenda":--b.options.month;0>b.options.month&&(b.options.month=11,--b.options.year);b.options.day=1;0>=b.options.year&&(b.options.day=1,b.options.month=0,b.options.year=1);u.refreshState("layout");break;case "map":case "month":--b.options.month;0>b.options.month&&(b.options.month=11,--b.options.year);0>=b.options.year&&(b.options.day=1,b.options.month=0,b.options.year=1);u.refreshState("layout");break;case "week":a=
g.getWeekInfo();a=g.newDate(a.start.year,a.start.month,a.start.day-7);b.options.year=a.getFullYear();b.options.month=a.getMonth();b.options.day=a.getDate();0>=b.options.year&&(b.options.day=1,b.options.month=0,b.options.year=1);u.refreshState("layout");break;case "day":1>b.options.day-1?(0>b.options.month-1?(--b.options.year,b.options.month=11):--b.options.month,a=g.getMonthInfo(),b.options.day=a.monthLength):--b.options.day,0>=b.options.year&&(b.options.day=1,b.options.month=0,b.options.year=1),
u.refreshState("layout")}});c.$top.find("[data-action='next']").on(g.clickHandle(),function(a){a.preventDefault();switch(b.options.view){case "boxgrid":case "grid":case "agenda":b.options.month+=1;11<b.options.month&&(b.options.month=0,b.options.year+=1);b.options.day=1;u.refreshState("layout");break;case "map":case "month":b.options.month+=1;11<b.options.month&&(b.options.month=0,b.options.year+=1);u.refreshState("layout");break;case "week":a=g.getWeekInfo();a=g.newDate(a.start.year,a.start.month,
a.start.day+7);b.options.year=a.getFullYear();b.options.month=a.getMonth();b.options.day=a.getDate();u.refreshState("layout");break;case "day":a=g.getMonthInfo(),b.options.day+1>a.monthLength?(11<b.options.month+1?(b.options.year+=1,b.options.month=0):b.options.month+=1,b.options.day=1):b.options.day+=1,u.refreshState("layout")}});c.$top.find("[data-action='today']").on(g.clickHandle(),function(a){a.preventDefault();a=new Date;b.options.year=a.getFullYear();b.options.month=a.getMonth();b.options.day=
a.getDate();u.refreshState("layout")})},set:function(){var a=[];0<a.length?(c.$top.find(".stec-top-menu-count").text(a.length),c.$top.find(".stec-top-menu-count").show()):c.$top.find(".stec-top-menu-count").hide();c.$top.find("[data-view]").removeClass("active");c.$top.find("[data-view='"+b.options.view+"']").addClass("active");c.$top.find(".stec-top-menu-date-month").hide();c.$top.find(".stec-top-menu-date-year").hide();c.$top.find(".stec-top-menu-date-week").hide();c.$top.find(".stec-top-menu-date-day").hide();
switch(b.options.view){case "boxgrid":case "grid":case "agenda":a=c.$top.find(".stec-top-menu-date-year").css("border-top-right-radius");c.$top.find(".stec-top-menu-date-month, .stec-top-menu-date-month .stec-top-menu-date-dropdown").css({borderTopLeftRadius:a,borderBottomLeftRadius:a});c.$top.find(".stec-top-menu-date-month").show();c.$top.find(".stec-top-menu-date-year").show();c.$top.find(".stec-top-menu-date-month > [data-month]").attr("data-month",b.options.month).text(b.options.monthLabels[b.options.month]);
c.$top.find(".stec-top-menu-date-day").show();c.$top.find(".stec-top-menu-date-day > [data-day]").attr("data-month",b.options.day).text(b.options.day);c.find(".stec-top-menu-date-year > [data-year]").attr("data-year",b.options.year).text(b.options.year);switch(b.options.general_settings.date_format){case "dd.mm.yyyy":c.$top.find(".stec-top-menu-date-small").text(b.options.day+". "+b.options.monthLabels[b.options.month]+" "+b.options.year);break;case "dd-mm-yy":c.$top.find(".stec-top-menu-date-small").text(b.options.day+
" "+b.options.monthLabels[b.options.month]+" "+b.options.year);break;case "mm-dd-yy":c.$top.find(".stec-top-menu-date-small").text(b.options.monthLabels[b.options.month]+" "+b.options.day+" "+b.options.year);break;case "yy-mm-dd":c.$top.find(".stec-top-menu-date-small").text(b.options.year+" "+b.options.monthLabels[b.options.month]+" "+b.options.day)}break;case "map":case "month":a=c.$top.find(".stec-top-menu-date-year").css("border-top-right-radius");c.$top.find(".stec-top-menu-date-month, .stec-top-menu-date-month .stec-top-menu-date-dropdown").css({borderTopLeftRadius:a,
borderBottomLeftRadius:a});c.$top.find(".stec-top-menu-date-month").show();c.$top.find(".stec-top-menu-date-year").show();c.$top.find(".stec-top-menu-date-month > [data-month]").attr("data-month",b.options.month).text(b.options.monthLabels[b.options.month]);c.find(".stec-top-menu-date-year > [data-year]").attr("data-year",b.options.year).text(b.options.year);switch(b.options.general_settings.date_format){case "dd.mm.yyyy":c.$top.find(".stec-top-menu-date-small").text(b.options.monthLabels[b.options.month]+
" "+b.options.year);break;case "dd-mm-yy":c.$top.find(".stec-top-menu-date-small").text(b.options.monthLabels[b.options.month]+" "+b.options.year);break;case "mm-dd-yy":c.$top.find(".stec-top-menu-date-small").text(b.options.monthLabels[b.options.month]+" "+b.options.year);break;default:c.$top.find(".stec-top-menu-date-small").text(b.options.year+" "+b.options.monthLabels[b.options.month])}break;case "week":a=g.getWeekInfo();if(a.start.year===a.end.year)if(a.start.month===a.end.month)switch(b.options.general_settings.date_format){case "dd.mm.yyyy":var d=
"sday. - eday. emonth. eyear";break;case "dd-mm-yy":d="sday - eday emonth eyear";break;case "mm-dd-yy":d="sday - emonth eday eyear";break;default:d="sday - eyear emonth eday"}else switch(b.options.general_settings.date_format){case "dd.mm.yyyy":d="sday. smonth. - eday. emonth. eyear";break;case "dd-mm-yy":d="sday smonth - eday emonth eyear";break;case "mm-dd-yy":d="smonth sday - emonth eday eyear";break;default:d="smonth sday - eyear emonth eday"}else switch(b.options.general_settings.date_format){case "dd.mm.yyyy":d=
"sday. smonth. syear - eday. emonth. eyear";break;case "dd-mm-yy":d="sday smonth syear - eday emonth eyear";break;case "mm-dd-yy":d="smonth sday syear - emonth eday eyear";break;default:d="syear smonth sday - eyear emonth eday"}d=g.getWeekLabel(d,a);c.$top.find(".stec-top-menu-date-week").show();c.$top.find(".stec-top-menu-date-week > [data-week]").attr("data-week",a.week).text(d);c.$top.find(".stec-top-menu-date-small").text(d);break;case "day":switch(c.$top.find(".stec-top-menu-date-month").css({borderRadius:0}).find(".stec-top-menu-date-dropdown").css({borderTopLeftRadius:0}),
c.$top.find(".stec-top-menu-date-day").show(),c.$top.find(".stec-top-menu-date-month").show(),c.$top.find(".stec-top-menu-date-year").show(),c.$top.find(".stec-top-menu-date-day > [data-day]").attr("data-day",b.options.day).text(b.options.day),c.$top.find(".stec-top-menu-date-month > [data-month]").attr("data-month",b.options.month).text(b.options.monthLabels[b.options.month]),c.$top.find(".stec-top-menu-date-year > [data-year]").attr("data-year",b.options.year).text(b.options.year),b.options.general_settings.date_format){case "dd.mm.yyyy":c.$top.find(".stec-top-menu-date-small").text(b.options.day+
". "+b.options.monthLabels[b.options.month]+" "+b.options.year);break;case "dd-mm-yy":c.$top.find(".stec-top-menu-date-small").text(b.options.day+" "+b.options.monthLabels[b.options.month]+" "+b.options.year);break;case "mm-dd-yy":c.$top.find(".stec-top-menu-date-small").text(b.options.monthLabels[b.options.month]+" "+b.options.day+" "+b.options.year);break;case "yy-mm-dd":c.$top.find(".stec-top-menu-date-small").text(b.options.year+" "+b.options.monthLabels[b.options.month]+" "+b.options.day)}}this.dateDropdownSetActive()},
dateDropdownSetActive:function(){c.$top.find(".stec-top-menu-date-dropdown .active").removeClass("active");c.$top.find(".stec-top-menu-date-dropdown").find('[data-day="'+b.options.day+'"]').parent().addClass("active");c.$top.find(".stec-top-menu-date-dropdown").find('[data-month="'+b.options.month+'"]').parent().addClass("active");c.$top.find(".stec-top-menu-date-dropdown").find('[data-year="'+b.options.year+'"]').parent().addClass("active");var a=g.getWeekInfo();a=a.start.year+"-"+a.start.month+
"-"+a.start.day;c.$top.find(".stec-top-menu-date-dropdown").find('[data-date="'+a+'"]').parent().addClass("active")},dateMonthScrollDown:function(){var a=[],d;c.$top.find(".stec-top-menu-date-month").find("ul").stop(!0,!0);var e=c.$top.find(".stec-top-menu-date-month").find("ul").first().find("li").last().find("[data-month]").attr("data-month");e=parseInt(e,10);for(d=0;5>=d;d++)e=11<e+1?0:e+1,a.push('<li><p data-month="'+e+'">'+b.options.monthLabels[e]+"</p></li>");c.$top.find(".stec-top-menu-date-month ul li").last().after(a.join(""));
c.$top.find(".stec-top-menu-date-month").find("ul").css({top:45}).stop(!0,!0).animate({top:-180},{duration:this.dropDownScrollSpeed,easing:"easeOutExpo",complete:function(){f(this).css("top",45).find("li").slice(0,5).remove()}});this.dateDropdownSetActive()},dateMonthScrollUp:function(){var a=c.$top.find(".stec-top-menu-date-month").find("ul").first().find("li").first().find("[data-month]").attr("data-month"),d=[],e;for(e=0;4>=e;e++)a=0>a-1?11:a-1,d[e]='<li><p data-month="'+a+'">'+b.options.monthLabels[a]+
"</p></li>";a=d.reverse().join("");c.$top.find(".stec-top-menu-date-month ul li").first().before(a);c.$top.find(".stec-top-menu-date-month").find("ul").css({top:-180}).stop().animate({top:45},{duration:this.dropDownScrollSpeed,easing:"easeOutExpo",complete:function(){f(this).css("top",45).find("li").slice(6).remove()}});this.dateDropdownSetActive()},dateYearScrollDown:function(){var a,d=[];c.$top.find(".stec-top-menu-date-year").find("ul").stop(!0,!0);var b=c.$top.find(".stec-top-menu-date-year").find("ul").first().find("li").last().find("[data-year]").attr("data-year");
b=parseInt(b,10);for(a=0;5>=a;a++)b+=1,d.push('<li><p data-year="'+b+'">'+b+"</p></li>");c.$top.find(".stec-top-menu-date-year ul li").last().after(d.join(""));c.$top.find(".stec-top-menu-date-year").find("ul").css({top:45}).stop(!0,!0).animate({top:-180},{duration:this.dropDownScrollSpeed,easing:"easeOutExpo",complete:function(){f(this).css("top",45).find("li").slice(0,5).remove()}});this.dateDropdownSetActive()},dateYearScrollUp:function(){var a=parseInt(c.$top.find(".stec-top-menu-date-year").find("ul").find("li").find("[data-year]").attr("data-year"),
10),d=[],b;for(b=0;4>=b;b++){--a;if(0>=a)break;d[b]='<li><p data-year="'+a+'">'+a+"</p></li>"}a=d.reverse().join("");c.$top.find(".stec-top-menu-date-year ul li").first().before(a);c.$top.find(".stec-top-menu-date-year").find("ul").css({top:-180}).stop().animate({top:45},{duration:this.dropDownScrollSpeed,easing:"easeOutExpo",complete:function(){f(this).css("top",45).find("li").slice(6).remove()}});this.dateDropdownSetActive()},dateWeekScrollDown:function(){var a=[],d;c.$top.find(".stec-top-menu-date-week").find("ul").stop(!0,
!0);var e=c.$top.find(".stec-top-menu-date-week").find("ul").last().find("li").last().find("[data-date]").attr("data-date");switch(b.options.general_settings.date_format){case "dd.mm.yyyy":var h="sday. smonth - eday. emonth. eyear";break;case "dd-mm-yy":h="sday smonth - eday emonth eyear";break;case "mm-dd-yy":h="smonth sday - emonth eday eyear";break;default:h="smonth sday - eyear emonth eday"}var n=g.getDateFromData(e);for(d=1;6>=d;d++){n.setDate(n.getDate()+7);e=g.getWeekInfo(n);var t=g.getWeekLabel(h,
e);var l=e.start.year+"-"+e.start.month+"-"+e.start.day;a.push('<li><p data-week="'+e.week+'" data-date="'+l+'">'+t+"</p></li>")}c.$top.find(".stec-top-menu-date-week ul li").last().after(a.join(""));c.$top.find(".stec-top-menu-date-week").find("ul").css({top:45}).stop(!0,!0).animate({top:-180},{duration:this.dropDownScrollSpeed,easing:"easeOutExpo",complete:function(){f(this).css("top",45).find("li").slice(0,5).remove()}});this.dateDropdownSetActive()},dateWeekScrollUp:function(){var a=c.$top.find(".stec-top-menu-date-week").find("ul").first().find("li").first().find("[data-date]").attr("data-date");
var d=[];var e=0;switch(b.options.general_settings.date_format){case "dd.mm.yyyy":var h="sday. smonth - eday. emonth. eyear";break;case "dd-mm-yy":h="sday smonth - eday emonth eyear";break;case "mm-dd-yy":h="smonth sday - emonth eday eyear";break;default:h="smonth sday - eyear emonth eday"}var n=g.getDateFromData(a);for(e=1;5>=e;e++){n.setDate(n.getDate()-7);a=g.getWeekInfo(n);if(0>=a.start.year)break;var t=g.getWeekLabel(h,a);var l=a.start.year+"-"+a.start.month+"-"+a.start.day;d[e]='<li><p data-week="'+
a.week+'" data-date="'+l+'">'+t+"</p></li>"}d=d.reverse().join("");c.$top.find(".stec-top-menu-date-week ul li").first().before(d);c.$top.find(".stec-top-menu-date-week").find("ul").css({top:-180}).stop().animate({top:45},{duration:this.dropDownScrollSpeed,easing:"easeOutExpo",complete:function(){f(this).css("top",45).find("li").slice(6).remove()}});this.dateDropdownSetActive()},dateDayScrollDown:function(){var a=[],d;c.$top.find(".stec-top-menu-date-day").find("ul").stop(!0,!0);var b=c.$top.find(".stec-top-menu-date-day").find("ul").first().find("li").last().find("[data-day]").attr("data-day");
b=parseInt(b,10);var h=g.getMonthInfo().monthLength;for(d=0;5>=d;d++)b=b+1>h?1:b+1,a.push('<li><p data-day="'+b+'">'+b+"</p></li>");c.$top.find(".stec-top-menu-date-day ul li").last().after(a.join(""));c.$top.find(".stec-top-menu-date-day").find("ul").css({top:45}).stop(!0,!0).animate({top:-180},{duration:this.dropDownScrollSpeed,easing:"easeOutExpo",complete:function(){f(this).css("top",45).find("li").slice(0,5).remove()}});this.dateDropdownSetActive()},dateDayScrollUp:function(){var a=c.$top.find(".stec-top-menu-date-day").find("ul").first().find("li").first().find("[data-day]").attr("data-day"),
b=g.getMonthInfo().monthLength,e=[],h;for(h=0;4>=h;h++)a=1>a-1?b:a-1,e[h]='<li><p data-day="'+a+'">'+a+"</p></li>";a=e.reverse().join("");c.$top.find(".stec-top-menu-date-day ul li").first().before(a);c.$top.find(".stec-top-menu-date-day").find("ul").css({top:-180}).stop().animate({top:45},{duration:this.dropDownScrollSpeed,easing:"easeOutExpo",complete:function(){f(this).css("top",45).find("li").slice(6).remove()}});this.dateDropdownSetActive()}},z={show:function(){clearTimeout(b.timeout.eventsLoading);
b.timeout.eventsLoading=setTimeout(function(){c.addClass("events-loading");c.trigger("onEventsLoaderShow")},500)},hide:function(){clearTimeout(b.timeout.eventsLoading);c.removeClass("events-loading");c.trigger("onEventsLoaderHide")}},m={init:function(){this.initViews();this.bindControls()},initViews:function(){"string"===typeof b.options.general_settings.views&&(b.options.general_settings.views=b.options.general_settings.views.split(","));-1!==f.inArray("agenda",b.options.general_settings.views)?
this.agenda.bindControls():(c.$agenda.remove(),c.$top.find('[data-view="agenda"]').remove());-1!==f.inArray("month",b.options.general_settings.views)?this.month.bindControls():(c.$month.remove(),c.$top.find('[data-view="month"]').remove());-1!==f.inArray("week",b.options.general_settings.views)?this.week.bindControls():(c.$week.remove(),c.$top.find('[data-view="week"]').remove());-1!==f.inArray("day",b.options.general_settings.views)?this.day.bindControls():(c.$day.remove(),c.$top.find('[data-view="day"]').remove());
-1!==f.inArray("grid",b.options.general_settings.views)?this.grid.bindControls():(c.$grid.remove(),c.$top.find('[data-view="grid"]').remove());-1!==f.inArray("boxgrid",b.options.general_settings.views)?this.boxgrid.bindControls():(c.$boxgrid.remove(),c.$top.find('[data-view="boxgrid"]').remove());-1!==f.inArray("map",b.options.general_settings.views)?(this.map.bindControls(),this.map.sidebar.bindControls()):(c.$map.remove(),c.$top.find('[data-view="map"]').remove());-1===f.inArray(b.options.view,
b.options.general_settings.views)&&(b.options.view=b.options.general_settings.views[0])},set:function(){c.$agenda.hide();c.$month.hide();c.$week.hide();c.$day.hide();c.$grid.hide();c.$boxgrid.hide();c.$map.hide();u.refreshState("top");switch(b.options.view){case "agenda":this.agenda.set();break;case "month":this.month.set();break;case "week":this.week.set();break;case "day":this.day.set();break;case "grid":this.grid.set();break;case "boxgrid":this.boxgrid.set();break;case "map":this.map.set()}g.extendBind("stachethemes_ec_extend",
"onLayoutSet")},agenda:{cache:{getNfutureEvents:!1},bindControls:function(){var a=this;g.onResizeEnd(function(){c.$agenda.is(":visible")&&a.set(!0)},50);c.$agenda.find(".stec-layout-agenda-events-all-load-more").on(g.clickHandle(),function(b){b.preventDefault();a.fillAgendaAllList()});f(document).on(g.clickHandle(),c.$agenda.path+" .stec-layout-agenda-daycell",function(c){c.preventDefault();f(this).hasClass("active")?(v.eventHolder.close(),f(this).removeClass("active")):(c=g.getDateFromData(f(this).attr("data-date")),
b.options.day=c.getDate(),b.options.month=c.getMonth(),b.options.year=c.getFullYear(),u.refreshState("top"),a.setActiveCell())});f(document).on(g.instaClickHandle(),c.$agenda.path+" .stec-layout-agenda-daycell",function(a){a.preventDefault();a=g.getDateFromData(f(this).attr("data-date"));var c=g.newDate(b.options.year,b.options.month,b.options.day);a.getTime()!==c.getTime()&&(b.options.day=a.getDate(),b.options.month=a.getMonth(),b.options.year=a.getFullYear(),u.refreshState("top"))});c.$agenda.find(".stec-layout-agenda-list").draggable({axis:"x",
start:function(a,b){c.$agenda.find(".stec-layout-agenda-list").stop();this.previousPosition=b.position;this.time=(new Date).getTime()},stop:function(c,b){c=(new Date).getTime()-this.time;var d=Math.abs(b.position.left-this.previousPosition.left);a.dragFill(f(this),b.position.left);a.inertia(f(this),this.previousPosition.left>b.position.left?1:-1,c,d)},drag:function(c,b){a.dragFill(f(this),b.position.left)}})},set:function(a){if(0!==parseInt(b.options.general_settings.agenda_cal_display,10)){var d=
this.getSlideDimensions(!0);c.$agenda.find(".stec-layout-agenda-list").stop().css({left:0,width:d.width});d=this.getCells(!1,!0,1,!0);c.$agenda.find(".stec-layout-agenda-list-b").empty().css("left",-1*c.$agenda.find(".stec-layout-agenda-list-a").width());this.fillHTML(c.$agenda.find(".stec-layout-agenda-list-a"),d)}else c.$agenda.find(".stec-layout-agenda-list-wrap").remove();!0!==a&&(v.eventHolder.close(),this.clearAgendaAllList(),this.fillAgendaAllList());c.$agenda.show()},setActiveCell:function(){var a=
[];var d=c.$agenda.find(".stec-layout-agenda-daycell[data-date='"+(b.options.year+"-"+b.options.month+"-"+b.options.day)+"']");c.$agenda.find(".stec-layout-agenda-daycell").removeClass("active");d.addClass("active");(d=d.find(".stec-layout-agenda-daycell-events").data("events"))&&f(d).each(function(){var c;(c=r.getEventById(this.id,this.offset))&&a.push(c)});v.eventHolder.openEvents(a)},getSlideDimensions:function(a){if(!0!==a&&this.getSlideDimensions.cache)return this.getSlideDimensions.cache;a=
2E3>f(window).width()?2E3:f(window).width();var b=Math.floor(c.width()/80);b=Math.floor(c.width()/b);a=Math.round(a/b);a={width:a*b,maxCells:a,cellWidth:b};return this.getSlideDimensions.cache=a},getCells:function(a,d,e,h){a||(a=g.newDate(b.options.year,b.options.month,b.options.day));var f=this.getSlideDimensions();var t=a.getDate();var l=g.getMonthInfo(a.getMonth());var k=a.getFullYear();if(!0===d)for(a=0;a<Math.round(f.maxCells/(f.width/c.width()*2));a++)--t,0>=t&&(l=l.month-1,0>l&&(l=11,--k),
l=g.getMonthInfo(l,k),t=l.monthLength);d=[];var q=0;if(1===e){for(e=0;e<f.maxCells;e++)t+=1,t>l.monthLength&&(l=l.month+1,11<l&&(k+=1,l=0),l=g.getMonthInfo(l,k),t=1,0!==q||!0===h)&&(d[q]={dataDate:!1,dayNum:!1,day:!1,year:k,month:l.month,monthStartCell:!0,hasEvents:!1},q++),a=g.newDate(k,l.month,t),d[q]={dataDate:k+"-"+l.month+"-"+t,dayNum:a.getDay(),day:t,year:k,month:l.month,monthStartCell:!1,hasEvents:!1},q++;d=d.slice(0,f.maxCells)}else{for(e=0;e<f.maxCells;e++){--t;if(0>=t){if(0!==q||!0===h)d[q]=
{dataDate:!1,dayNum:!1,day:!1,year:k,month:l.month,monthStartCell:!0,hasEvents:!1},q++;l=l.month-1;0>l&&(--k,l=11);l=g.getMonthInfo(l,k);t=l.monthLength}a=g.newDate(k,l.month,t);d[q]={dataDate:k+"-"+l.month+"-"+t,dayNum:a.getDay(),day:t,year:k,month:l.month,monthStartCell:!1,hasEvents:!1};q++}d=d.slice(0,f.maxCells);d.reverse()}return d},fillHTML:function(a,d){var e=this.getSlideDimensions(),h=[];a.empty();f(d).each(function(){!0===this.monthStartCell?(h.push('<li style="width: '+e.cellWidth+'px" class="stec-layout-agenda-monthstart" data-year="'+
this.year+'" data-month="'+this.month+'" >'),h.push('<div class="stec-layout-agenda-monthstart-wrap">'),h.push('<p class="stec-layout-agenda-monthstart-year">'+this.year+"</p>"),h.push('<p class="stec-layout-agenda-monthstart-month">'+b.options.monthLabelsShort[this.month]+"</p>")):(h.push('<li style="width: '+e.cellWidth+'px" class="stec-layout-agenda-daycell" data-date="'+this.dataDate+'">'),h.push('<div class="stec-layout-agenda-daycell-wrap">'),h.push('<p class="stec-layout-agenda-daycell-label">'+
b.options.dayLabelsShort[this.dayNum]+"</p>"),h.push('<p class="stec-layout-agenda-daycell-num">'+this.day+"</p>"),h.push('<div class="stec-layout-agenda-daycell-events">'),h.push("</div>"));h.push("</div>");h.push("</li>")});a[0].innerHTML+=h.join("");a=new Date;a=a.getFullYear()+"-"+a.getMonth()+"-"+a.getDate();c.$agenda.find(".stec-layout-agenda-daycell[data-date='"+a+"']").addClass("stec-layout-agenda-daycell-today");this.fillEvents()},fillEvents:function(){var a=c.$agenda.find(".stec-layout-agenda-list-a");
var b=c.$agenda.find(".stec-layout-agenda-list-b");if(0>=b.children().length){var e=a.children(".stec-layout-agenda-daycell").first().attr("data-date");b=a.children(".stec-layout-agenda-daycell").last().attr("data-date")}else a[0].offsetLeft>b[0].offsetLeft?(e=b.children(".stec-layout-agenda-daycell").first().attr("data-date"),b=a.children(".stec-layout-agenda-daycell").last().attr("data-date")):(b=b.children(".stec-layout-agenda-daycell").last().attr("data-date"),e=a.children(".stec-layout-agenda-daycell").first().attr("data-date"));
c.$agenda.children(".stec-layout-agenda-list-wrap").find(".stec-layout-agenda-daycell-events").empty();a=g.getDateFromData(e);b=g.getDateFromData(b);z.show();r.getEventsThread(a,b,!0,"agenda").then(function(a){z.hide();0>=a.length||(c.$agenda.find(".stec-layout-agenda-daycell").find(".stec-layout-agenda-daycell-events").data("events",null),f(a).each(function(){var a=p.tz(this.start_date,this.timezone),b=p.tz(this.end_date,this.timezone),d=[],h=g.getEventState(this);a=Math.abs(a.startOf("day").diff(b.startOf("day"),
"days"));for(b=0;b<=a;b++){var e=p(this.start_date).add(b,"days").unix();var k=g.getDataFromDate(new Date(1E3*e));e=c.$agenda.find('.stec-layout-agenda-daycell[data-date="'+k+'"]').find(".stec-layout-agenda-daycell-events");2<e.children(".stec-layout-agenda-daycell-event").length||(0<h&&d.push("stec-layout-agenda-daycell-event-expired"),d.push("stec-layout-agenda-daycell-event"),f("<div></div>").attr({"data-id":this.id,"data-repeat-time-offset":this.repeat_time_offset,style:"background-color: "+this.color,
"class":d.join(" ")}).appendTo(c.$agenda.children(".stec-layout-agenda-list-wrap").find('.stec-layout-agenda-daycell[data-date="'+k+'"]').find(".stec-layout-agenda-daycell-events")));(k=e.data("events"))||(k=[]);k.push({id:this.id,offset:this.repeat_time_offset});e.data("events",k)}}),g.extendBind("stachethemes_ec_extend","afterFillEvents"))})},dragFill:function(a,b){var c,d=a.parent().children(".stec-layout-agenda-list").not(a);d.css("left",b+(0>b?1:-1)*a.width());if(d[0].offsetLeft>a[0].offsetLeft){var f=
!1;b=g.getDateFromData(a.children(".stec-layout-agenda-daycell").last().attr("data-date"));(c=d.children(".stec-layout-agenda-daycell").first().attr("data-date"))?(c=g.getDateFromData(c),c.setDate(c.getDate()-1),b.getTime()!==c.getTime()&&(f=!0)):f=!0;!0===f&&(f=!0,a.children("li").last().hasClass("stec-layout-agenda-monthstart")&&(f=!1),b.setDate(b.getDate()),a=this.getCells(b,!1,1,f),this.fillHTML(d,a))}else f=!1,b=g.getDateFromData(a.children(".stec-layout-agenda-daycell").first().attr("data-date")),
(c=d.children(".stec-layout-agenda-daycell").last().attr("data-date"))?(c=g.getDateFromData(c),c.setDate(c.getDate()+1),b.getTime()!==c.getTime()&&(f=!0)):f=!0,!0===f&&(f=!0,a.children("li").first().hasClass("stec-layout-agenda-monthstart")&&(f=!1),a=this.getCells(b,!1,-1,f),this.fillHTML(d,a))},inertia:function(a,b,f,h){var d=this,e=0;e=h/f*100;e=e>a.width()?a.width()/4:e;c.$agenda.find(".stec-layout-agenda-list").stop();switch(b){case 1:a.animate({left:a.position().left-e},{easing:"easeOutExpo",
duration:1E3,step:function(b,c){d.dragFill(a,c.now)}});break;case -1:a.animate({left:a.position().left+e},{easing:"easeOutExpo",duration:1E3,step:function(b,c){d.dragFill(a,c.now)}})}},clearAgendaAllList:function(){this.cache.getNfutureEvents=!1;c.$agenda.find(".stec-layout-agenda-events-all ul").remove();c.$agenda.find(".stec-layout-agenda-events-all-datetext").remove()},getNfutureEvents:function(){var a=this;return new Promise(function(c){var d={events:[],loadMore:!1};if(a.cache.getNfutureEvents){var h=
a.getNfutureEvents.i++*a.getNfutureEvents.n;var g=h+a.getNfutureEvents.n;d.events=a.cache.getNfutureEvents.slice(h,g);d.loadMore=0<a.cache.getNfutureEvents.slice(g,g+1).length?!0:!1;return c(d)}a.getNfutureEvents.n=parseInt(b.options.general_settings.agenda_get_n,10);r.getFutureEventsThread(!0,"getNfutureEvents").then(function(e){1===parseInt(b.options.general_settings.reverse_agenda_list,10)?a.cache.getNfutureEvents=f(e).get().reverse():a.cache.getNfutureEvents=e;a.getNfutureEvents.i=0;h=a.getNfutureEvents.i++*
a.getNfutureEvents.n;g=h+a.getNfutureEvents.n;d.events=a.cache.getNfutureEvents.slice(h,g);d.loadMore=0<a.cache.getNfutureEvents.slice(g,g+1).length?!0:!1;return c(d)})})},fillAgendaAllList:function(){var a,d;0!==parseInt(b.options.general_settings.agenda_list_display,10)&&(c.$agenda.find(".stec-layout-agenda-events-all-control").hide(),this.getNfutureEvents().then(function(e){var h=e.events;e=e.loadMore;if(!h||0>=h.length)0>=c.$agenda.find(".stec-layout-agenda-events-all-list").children().length&&
c.$agenda.find(".stec-layout-agenda-noevents").show();else{!0===e&&c.$agenda.find(".stec-layout-agenda-events-all-control").show();a=c.$agenda.find(".stec-layout-agenda-events-all-datetext").last();a.month=a.attr("data-month");a.year=a.attr("data-year");f(h).each(function(h){var e=this;h=[];var l=[],n=g.getEventState(this),q=g.dbDateTimeToDate(this.start_date);(0<n||"EventCancelled"===e.event_status||"0"===b.options.general_settings.reminder)&&h.push("stec-layout-event-no-reminder");if(parseInt(a.month,
10)!==q.getMonth()||parseInt(a.year,10)!==q.getFullYear())a.month=q.getMonth(),a.year=q.getFullYear(),f('<p data-year="'+q.getFullYear()+'" data-month="'+q.getMonth()+'" class="stec-layout-agenda-events-all-datetext">'+b.options.monthLabels[q.getMonth()]+" "+q.getFullYear()+"</p>").insertBefore(c.$agenda.find(".stec-layout-agenda-events-all-control")),f('<ul class="stec-layout-agenda-events-all-list"></ul>').insertAfter(c.$agenda.find(".stec-layout-agenda-events-all-datetext").last());switch(parseInt(this.featured,
10)){case 1:h.push("stec-event-featured");break;case 2:h.push("stec-event-featured stec-event-featured-bg")}"EventCancelled"===e.event_status&&h.push("stec-event-cancelled");"icon"!==e.icon_type||e.icon&&"fa"!==e.icon||h.push("stec-no-icon");e.edit_link||h.push("stec-no-edit");(e.description_short&&"1"===b.options.general_settings.preview_desc||e.location.full_address&&"1"===b.options.general_settings.preview_location)&&h.push("stec-layout-event-preview-size-big");switch(e.icon_type){case "image":0<
e.icon_images.length?(l.push('<div class="stec-layout-event-preview-left-icon-images">'),f.each(e.icon_images_meta,function(a){l.push('<div class="stec-layout-event-preview-left-icon-image '+(0===a?"active":"")+'" style="background-image: url('+this.src+')"></div>')}),l.push("</div>")):l.push('<i class="'+e.icon+'"></i>');break;case "date":d=p(e.start_date);l.push('<span class="stec-layout-event-preview-left-icon-date"><span class="stec-layout-event-preview-left-icon-date-number">'+d.format("D")+
'</span><span class="stec-layout-event-preview-left-icon-date-month">'+k(d.format("MMM").toLowerCase())+"</span></span>");break;default:l.push('<i class="'+e.icon+'"></i>')}f(b.template.event).addClass(h.join(" ")).attr("data-id",e.id).attr("data-repeat-time-offset",e.repeat_time_offset?e.repeat_time_offset:0).data("permalink",g.getPermalink(e.permalink,e.repeat_time_offset)).html(function(a,d){a=f(d);d=g.beautifyTimespan(e.start_date,1===parseInt(e.hide_end,10)?!1:e.end_date,e.all_day);var h=parseInt(e.timezone_utc_offset,
10)/3600,n=[];h=0<h?"+"+h:h;0===h&&(h="");h=(0===parseInt(b.options.general_settings.date_label_gmtutc,10)?"":"UTC/GMT "+h).trim();e.location.full_address&&"1"===b.options.general_settings.preview_location||a.find(".stec-layout-event-preview-left-text-location").remove();e.description_short&&"1"===b.options.general_settings.preview_desc||a.find(".stec-layout-event-preview-left-text-desc").remove();b.temp.EventPreviewHtml=a.get(0).outerHTML;c.trigger("stecBeforeReturnEventPreviewHtml",{$instance:c,
event:e,temp:b.temp});switch(e.event_status){case "EventCancelled":n.push('<p class="stec-layout-event-preview-left-text-event-status"><span class="cancelled">'+k("Cancelled")+"</span></p>");break;case "EventMovedOnline":n.push('<p class="stec-layout-event-preview-left-text-event-status"><span class="moved-online">'+k("Moved Online")+"</span></p>");break;case "EventPostponed":n.push('<p class="stec-layout-event-preview-left-text-event-status"><span class="postponed">'+k("Postponed")+"</span></p>");
break;case "EventRescheduled":n.push('<p class="stec-layout-event-preview-left-text-event-status"><span class="rescheduled">'+k("Rescheduled")+"</span></p>");break;default:n=[]}0===e.approved&&n.push('<p class="stec-layout-event-preview-left-text-event-status"><span class="unapproved">'+k("Awaiting Approval")+"</span></p>");return b.temp.EventPreviewHtml.replace("stec_replace_event_status",n.join("")).replace("stec_replace_summary",e.title).replace("stec_replace_date",d+" "+h).replace("stec_replace_location",
function(){return"virtual"===e.location.type?k("Online Event"):e.location.title?[e.location.title,e.location.full_address].join(", "):e.location.full_address}).replace("stec_replace_desc_short",e.description_short).replace('stec_replace_event_background=""','style="background:'+e.color+'"').replace("stec_replace_icon",l.join("")).replace(/#stec_replace_edit_link/g,e.edit_link)}).appendTo(c.find(".stec-layout-agenda-events-all-list").last())});switch(b.options.general_settings.open_event_in){case "single":case "external":case "modal":c.find(".stec-layout-agenda-events-all").find(".stec-layout-event-preview-right-event-toggle").remove()}c.$agenda.find(".stec-layout-agenda-noevents").hide();
g.animate.agenda.fillList(c.$agenda)}}))}},month:{bindControls:function(){var a=this;c.$month.find(".stec-layout-month-daycell").on(g.clickHandle(),function(c){c.preventDefault();f(this).hasClass("active")?(v.eventHolder.close(),f(this).removeClass("active")):(c=g.getDateFromData(f(this).attr("data-date")),b.options.year=c.getFullYear(),b.options.month=c.getMonth(),b.options.day=c.getDate(),a.setActiveCell())})},set:function(){c.$month.show();this.setDayLabels();this.fillGridDays();this.fillEvents()},
setDayLabels:function(){var a=0;switch(b.options.general_settings.first_day_of_the_week){case "mon":a=1;break;case "sat":a=6;break;case "sun":a=0}var d=a;c.$month.find(".stec-layout-month-daylabel td").each(function(a){a=g.capitalizeFirstLetter(b.options.dayLabels[d]);var c=g.capitalizeFirstLetter(b.options.dayLabelsShort[d]);f(this).find("p").eq(0).text(a);f(this).find("p").eq(1).text(c);f(this).find("p").eq(2).text(c.charAt(0));d=d+1>=b.options.dayLabels.length?0:d+1})},setActiveCell:function(){var a=
[];var d=c.$month.find(".stec-layout-month-daycell[data-date='"+(b.options.year+"-"+b.options.month+"-"+b.options.day)+"']");c.$month.find(".stec-layout-month-daycell").removeClass("active");d.addClass("active");c.$month.find(".stec-layout-month-eventholder").insertAfter(c.$month.find(".stec-layout-month-daycell.active").parents("tr"));(d=d.find(".stec-layout-month-daycell-events").data("events"))&&f(d).each(function(){var b;(b=r.getEventById(this.id,this.offset))&&a.push(b)});v.eventHolder.openEvents(a)},
resetGridCells:function(){c.$month.find(".stec-layout-month-daylabel td").removeClass("stec-layout-month-daylabel-today");c.$month.find(".stec-layout-month-daycell").removeAttr("data-date").removeClass("stec-layout-month-daycell-today stec-layout-month-daycell-inactive active");c.$month.find(".stec-layout-month-daycell").removeClass("active");c.$month.find(".stec-layout-month-daycell-events").empty();v.eventHolder.close()},fillGridDays:function(){var a;this.resetGridCells();var b=g.getMonthInfo();
for(a=0;a<b.monthLength;a++){var e=a+1;c.$month.find(".stec-layout-month-daycell").eq(b.dayOffset+a).attr("data-date",b.year+"-"+b.month+"-"+e).find(".stec-layout-month-daycell-num").text(e)}var h=g.getMonthInfo(0>b.month-1?11:b.month-1,0>b.month-1?b.year-1:b.year);for(a=b.dayOffset;0<a;a--)e=h.monthLength-b.dayOffset+a,c.$month.find(".stec-layout-month-daycell").eq(a-1).addClass("stec-layout-month-daycell-inactive").attr("data-date",h.year+"-"+h.month+"-"+e).find(".stec-layout-month-daycell-num").text(e);
var f=g.getMonthInfo(11<b.month+1?0:b.month+1,11<b.month+1?b.year+1:b.year);for(a=0;a<42-(b.monthLength+b.dayOffset);a++)h=b.monthLength+b.dayOffset+a,e=a+1,c.$month.find(".stec-layout-month-daycell").eq(h).addClass("stec-layout-month-daycell-inactive").attr("data-date",f.year+"-"+f.month+"-"+e).find(".stec-layout-month-daycell-num").text(e);a=new Date;a=a.getFullYear()+"-"+a.getMonth()+"-"+a.getDate();c.$month.find(".stec-layout-month-daycell[data-date='"+a+"']").addClass("stec-layout-month-daycell-today");
0<c.$month.find(".stec-layout-month-daycell-today").length&&(h=c.$month.find(".stec-layout-month-weekrow").find(".stec-layout-month-daycell[data-date='"+a+"']").index(),c.$month.find(".stec-layout-month-daylabel td").eq(h).addClass("stec-layout-month-daylabel-today"))},fillEvents:function(){var a=this,d=g.getDateFromData(c.$month.find(".stec-layout-month-daycell").first().attr("data-date")),e=g.getDateFromData(c.$month.find(".stec-layout-month-daycell").last().attr("data-date"));c.$month.find(".stec-layout-month-daycell").find(".stec-layout-month-daycell-events").data("events",
null);z.show();r.getEventsThread(d,e,!0,"base").then(function(d){z.hide();f(d).each(function(){var d=[];var h=p.tz(this.start_date,this.timezone);var e=p.tz(this.end_date,this.timezone);var m=g.getEventState(this);h=Math.abs(h.startOf("day").diff(e.startOf("day"),"days"));for(e=0;e<=h;e++){var q=[];var r=g.getDataFromDate(p(this.start_date).add(e,"days").toDate());r=c.$month.find('.stec-layout-month-daycell[data-date="'+r+'"]').find(".stec-layout-month-daycell-events");if(2<r.find(".stec-layout-month-daycell-event").length||
-1<d.indexOf(this.id)){if(0<r.find(".stec-layout-month-daycell-eventmore").length)q=r.find(".stec-layout-month-daycell-eventmore-count").text(),q=parseInt(q.match(/[0-9]+/),10)+1,q="+"+q+" "+k("morePlural"),r.find(".stec-layout-month-daycell-eventmore-count").text(q);else{var w=[];w.push('<li class="stec-layout-month-daycell-eventmore">');w.push('   <p class="stec-layout-month-daycell-eventmore-count">+1 '+k("moreSingular")+"</p>");w.push('   <p class="stec-layout-month-daycell-eventmore-count-dot"></p>');
w.push('   <p class="stec-layout-month-daycell-eventmore-count-dot"></p>');w.push('   <p class="stec-layout-month-daycell-eventmore-count-dot"></p>');w.push("</li>");f(w.join("")).appendTo(r)}var u=this.repeat_time_offset?this.repeat_time_offset:0;d.push(this.id)}else{var v="background-color:"+this.color;0===e&&q.push("stec-layout-month-daycell-event-start");e===h&&q.push("stec-layout-month-daycell-event-end");switch(parseInt(this.featured,10)){case 1:q.push("stec-event-featured");break;case 2:q.push("stec-event-featured stec-event-featured-bg")}var A=
a.getEventPosition(this,r);u=g.getColorBrightness(this.color);170<u&&q.push("stec-layout-month-daycell-event-bright");0<m&&q.push("stec-layout-month-daycell-event-expired");u=this.repeat_time_offset?this.repeat_time_offset:0;var I=this.id+"-"+u;w=[];w.push("<li>");0!==e&&0===parseInt(b.options.general_settings.show_event_title_all_cells,10)||w.push('<p class="stec-layout-month-daycell-event-name">'+this.title+"</p>");w.push("</li>");q.push("stec-layout-month-daycell-event");"EventCancelled"===this.event_status&&
q.push("stec-event-cancelled");f(w.join("")).attr({"class":q.join(" "),style:v,"data-pos":A,"data-pos-id":I,"data-repeat-time-offset":u,"data-id":this.id}).appendTo(r)}(q=r.data("events"))||(q=[]);q.push({id:this.id,offset:u});r.data("events",q)}});g.extendBind("stachethemes_ec_extend","afterFillEvents")})},getEventPosition:function(a,b){var d=0,h=[1,2,3];a=c.$month.find('.stec-layout-month-daycell-event[data-pos-id="'+(a.id+"-"+(a.repeat_time_offset?a.repeat_time_offset:0))+'"]').first();0<a.length?
d=a.attr("data-pos"):(b.find(".stec-layout-month-daycell-event").each(function(){var a=h.indexOf(parseInt(f(this).attr("data-pos"),10));-1<a&&h.splice(a,1)}),d=h[0]);return d}},week:{bindControls:function(){var a=this,d;c.$week.find(".stec-layout-week-daycell").on(g.clickHandle(),function(c){c.preventDefault();f(this).hasClass("active")?(v.eventHolder.close(),f(this).removeClass("active")):(d=g.getDateFromData(f(this).attr("data-date")),b.options.year=d.getFullYear(),b.options.month=d.getMonth(),
b.options.day=d.getDate(),a.setActiveCell())});g.onResizeEnd(function(){a.calcHeight()})},set:function(){c.$week.show();this.setDayLabels();this.fillGridDays();this.fillEvents()},setDayLabels:function(){var a=0;switch(b.options.general_settings.first_day_of_the_week){case "mon":a=1;break;case "sat":a=6;break;case "sun":a=0}var d=a;c.$week.find(".stec-layout-week-daylabel td").each(function(a){a=g.capitalizeFirstLetter(b.options.dayLabels[d]);var c=g.capitalizeFirstLetter(b.options.dayLabelsShort[d]);
f(this).find("p").eq(0).text(a);f(this).find("p").eq(1).text(c);f(this).find("p").eq(2).text(c.charAt(0));d=d+1>=b.options.dayLabels.length?0:d+1})},setActiveCell:function(){var a=c.$week.find(".stec-layout-week-daycell[data-date='"+(b.options.year+"-"+b.options.month+"-"+b.options.day)+"']"),d=[],e=[];c.$week.find(".stec-layout-week-daycell").removeClass("active");a.addClass("active");(d=a.find(".stec-layout-week-daycell-events").data("events"))&&f(d).each(function(){var a;(a=r.getEventById(this.id,
this.offset))&&e.push(a)});v.eventHolder.openEvents(e)},resetGridCells:function(){c.$week.find(".stec-layout-week-daylabel td").removeClass("stec-layout-week-daylabel-today");c.$week.find(".stec-layout-week-daycell").removeAttr("data-date").removeClass("stec-layout-week-daycell-today stec-layout-week-daycell-inactive active");c.$week.find(".stec-layout-week-daycell").removeClass("active");c.$week.find(".stec-layout-week-daycell-events").empty();v.eventHolder.close()},fillGridDays:function(){var a=
g.getWeekInfo(),b=g.newDate(a.start.year,a.start.month,a.start.day);this.resetGridCells();c.$week.find(".stec-layout-week-daycell").each(function(a){a=p(b).add(a,"days").toDate();f(this).attr("data-date",a.getFullYear()+"-"+a.getMonth()+"-"+a.getDate()).find(".stec-layout-week-daycell-num").text(a.getDate())});a=new Date;a=a.getFullYear()+"-"+a.getMonth()+"-"+a.getDate();c.$week.find(".stec-layout-week-daycell[data-date='"+a+"']").addClass("stec-layout-week-daycell-today");0<c.$week.find(".stec-layout-week-daycell-today").length&&
(a=c.$week.find(".stec-layout-week-weekrow").find(".stec-layout-week-daycell[data-date='"+a+"']").index(),c.$week.find(".stec-layout-week-daylabel td").eq(a).addClass("stec-layout-week-daylabel-today"))},calcHeight:function(){var a=c.hasClass("stec-media-small")?50:160,b=c.hasClass("stec-media-small")?20:113,e=c.hasClass("stec-media-small")?6:29,h=c.hasClass("stec-media-small")?40:70;c.$week.find(".stec-layout-week-daycell").css("height",a);c.$week.find(".stec-layout-week-daycell-events").css("height",
b);c.$week.find(".stec-layout-week-daycell-events").children().each(function(){var c=parseInt(f(this).attr("data-pos"),10);f(this).css({top:e*c});a=Math.max(a,h+e*c);b=a-30});c.$week.find(".stec-layout-week-daycell").css("height",a);c.$week.find(".stec-layout-week-daycell-events").css("height",b)},fillEvents:function(){var a=this,d=g.getDateFromData(c.$week.find(".stec-layout-week-daycell").first().attr("data-date")),e=g.getDateFromData(c.$week.find(".stec-layout-week-daycell").last().attr("data-date"));
c.$week.find(".stec-layout-week-daycell").find(".stec-layout-week-daycell-events").data("events",null);z.show();r.getEventsThread(d,e,!0,"base").then(function(d){z.hide();d&&(f(d).each(function(){var d=p.tz(this.start_date,this.timezone),h=p.tz(this.end_date,this.timezone),e=g.getEventState(this);d=Math.abs(d.startOf("day").diff(h.startOf("day"),"days"));for(h=0;h<=d;h++){var k=[];var q=g.getDataFromDate(p(this.start_date).add(h,"days").toDate());q=c.$week.find('.stec-layout-week-daycell[data-date="'+
q+'"]').find(".stec-layout-week-daycell-events");var m="background-color:"+this.color;0===h&&k.push("stec-layout-week-daycell-event-start");h===d&&k.push("stec-layout-week-daycell-event-end");switch(parseInt(this.featured,10)){case 1:k.push("stec-event-featured");break;case 2:k.push("stec-event-featured stec-event-featured-bg")}var r=this.repeat_time_offset?this.repeat_time_offset:0;var u=this.id+"-"+r;var v=a.getEventPosition(this,q);var A=g.getColorBrightness(this.color);170<A&&k.push("stec-layout-week-daycell-event-bright");
0<e&&k.push("stec-layout-week-daycell-event-expired");k.push("stec-layout-week-daycell-event");A=[];A.push("<li>");0!==h&&0===parseInt(b.options.general_settings.show_event_title_all_cells,10)||A.push('<p class="stec-layout-week-daycell-event-name">'+this.title+"</p>");A.push("</li>");"EventCancelled"===this.event_status&&k.push("stec-event-cancelled");f(A.join("")).attr({"class":k.join(" "),style:m,"data-pos":v,"data-pos-id":u,"data-repeat-time-offset":r,"data-id":this.id}).appendTo(q);(k=q.data("events"))||
(k=[]);k.push({id:this.id,offset:r});q.data("events",k)}}),a.calcHeight(),g.extendBind("stachethemes_ec_extend","afterFillEvents"))})},getEventPosition:function(a,b){var d=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],h=0;a=c.$week.find('.stec-layout-week-daycell-event[data-pos-id="'+(a.id+"-"+(a.repeat_time_offset?a.repeat_time_offset:0))+'"]').first();0<a.length?h=a.attr("data-pos"):(b.find(".stec-layout-week-daycell-event").each(function(){var a=d.indexOf(parseInt(f(this).attr("data-pos"),
10));-1<a&&d.splice(a,1)}),h=d[0]);return h}},day:{bindControls:function(){},set:function(){var a=g.newDate(b.options.year,b.options.month,b.options.day);v.eventHolder.close();c.$day.show();r.getEventsThread(a,a,!0,"base").then(function(a){v.eventHolder.openEvents(a);g.extendBind("stachethemes_ec_extend","afterFillEvents")})}},grid:{cache:{getNfutureEvents:!1},columns:0,options:{offset:0,perClick:4,blockMinWidth:270,defaultColumns:4,gutter:10},bindControls:function(){var a=this;this.options.defaultColumns=
parseInt(b.options.general_settings.grid_columns,10);this.options.gutter=parseInt(b.options.general_settings.grid_gutter,10);this.options.perClick=parseInt(b.options.general_settings.grid_per_click,10);this.options.gutter||c.$grid.find(".stec-layout-grid-events-all-load-more").css({marginTop:10});c.$grid.find(".stec-layout-grid-events-all-load-more").on(g.clickHandle(),function(b){b.preventDefault();a.fill()});if("modal"===b.options.general_settings.open_event_in)c.$grid.on(g.clickHandle(),".stec-layout-grid-event .stec-layout-grid-event-title, .stec-layout-grid-event .stec-layout-grid-event-image",
function(a){a.preventDefault();v.eventToggle(f(this).parents(".stec-layout-grid-event").first())});g.onResizeEnd(function(){a.resizeEvents()},50);c.on("onEventsLoaderShow",function(){"grid"===b.options.view&&(m.grid.placeholders.remove(),m.grid.placeholders.add())});c.on("onEventsLoaderHide",function(){"grid"===b.options.view&&m.grid.placeholders.remove()})},set:function(){c.$grid.show();this.clear();this.fill()},clear:function(){this.cache.getNfutureEvents=!1;c.$grid.find(".stec-layout-grid-events").children(".stec-layout-grid-event").remove();
c.$grid.find(".stec-layout-grid-noevents").hide()},getNfutureEvents:function(){var a=this;return new Promise(function(c){var d={events:[],loadMore:!1};if(a.cache.getNfutureEvents){var h=a.getNfutureEvents.i++*a.getNfutureEvents.n;var g=h+a.getNfutureEvents.n;d.events=a.cache.getNfutureEvents.slice(h,g);d.loadMore=0<a.cache.getNfutureEvents.slice(g,g+1).length?!0:!1;return c(d)}a.getNfutureEvents.n=a.options.perClick;r.getFutureEventsThread(!0,"getFutureEventsThread").then(function(e){1===parseInt(b.options.general_settings.reverse_agenda_list,
10)?a.cache.getNfutureEvents=f(e).get().reverse():a.cache.getNfutureEvents=e;a.getNfutureEvents.i=0;h=a.getNfutureEvents.i++*a.getNfutureEvents.n;g=h+a.getNfutureEvents.n;d.events=a.cache.getNfutureEvents.slice(h,g);d.loadMore=0<a.cache.getNfutureEvents.slice(g,g+1).length?!0:!1;return c(d)})})},placeholders:{html:function(){var a=[];a.push('<div class="stec-layout-grid-event-placeholder">');a.push('<span class="noanim"></span>');a.push("<span></span>");a.push("<div><span></span><span></span></div>");
a.push("<div><span></span><span></span></div>");a.push("</div>");return a.join("")},add:function(){var a,b=[];b.push('<div class="stec-layout-grid-event-placeholders-wrap">');m.grid.calcColumns();for(a=0;a<m.grid.columns;a++)b.push(this.html());b.push("</div>");f(b.join("")).appendTo(c.$grid.find(".stec-layout-grid-events"))},remove:function(){c.$grid.find(".stec-layout-grid-events").children(".stec-layout-grid-event-placeholders-wrap").remove()}},fill:function(){var a=this;z.show();this.getNfutureEvents().then(function(d){var e=
d.events;d=d.loadMore;z.hide();!e||0>=e.length?(c.$grid.find(".stec-layout-grid-events-all-control").hide(),0>=c.$grid.find(".stec-layout-grid-events").children().length&&(c.$grid.find(".stec-layout-grid-noevents").show(),c.$grid.find(".stec-layout-grid-events").height(0))):(!1===d?c.$grid.find(".stec-layout-grid-events-all-control").hide():c.$grid.find(".stec-layout-grid-events-all-control").show(),f(e).each(function(){var a=this,d=!1,e=[],l=[],m=g.getEventState(this);(0<m||"EventCancelled"===a.event_status||
"0"===b.options.general_settings.reminder)&&l.push("stec-layout-event-no-reminder");switch(parseInt(this.featured,10)){case 1:l.push("stec-event-featured");break;case 2:l.push("stec-event-featured stec-event-featured-bg")}"icon"!==a.icon_type||a.icon&&"fa"!==a.icon||l.push("stec-no-icon");a.edit_link||l.push("stec-no-edit");0<a.images_meta.length&&l.push("stec-has-image");0<a.products.length&&l.push("stec-has-products");a.location.full_address&&l.push("stec-has-location");0<a.organizers.length&&l.push("stec-has-organizers");
switch(a.event_status){case "EventCancelled":e.push('<span class="cancelled">'+k("Cancelled")+"</span>");break;case "EventMovedOnline":e.push('<span class="moved-online">'+k("Moved Online")+"</span>");break;case "EventPostponed":e.push('<span class="postponed">'+k("Postponed")+"</span>");break;case "EventRescheduled":e.push('<span class="rescheduled">'+k("Rescheduled")+"</span>")}0===a.approved&&e.push('<span class="unapproved">'+k("Awaiting Approval")+"</span>");0<a.featured&&e.push('<span class="stec-featured-tag">'+
k("featured")+"</span>");f.each(a.category,function(){e.push('<span style="background-color:'+this.color+'">'+this.title+"</span>")});0<e.length&&l.push("stec-has-tags");isNaN(b.options.userid)||f(a.attendance).each(function(){if(this.userid===b.options.userid)return d=!0,!1});d?l.push("stec-user-invited"):1===parseInt(a.rsvp,10)&&l.push("stec-can-rsvp");-1!==f.inArray(["EventCancelled","EventPostponed"],a.event_status)&&(2===m?l.push("stec-expired"):1===m&&l.push("stec-in-progress"));"EventCancelled"===
a.event_status&&l.push("stec-event-cancelled");f(b.template.gridevent).addClass(l.join(" ")).attr({"data-id":a.id,"data-repeat-time-offset":a.repeat_time_offset?a.repeat_time_offset:0}).html(function(c,d){c=g.beautifyTimespan(a.start_date,1===parseInt(a.hide_end,10)?!1:a.end_date,a.all_day);var h=parseInt(a.timezone_utc_offset,10)/3600,l="",n="",t=[];h=0<h?"+"+h:h;0===h&&(h="");h=0===parseInt(b.options.general_settings.date_label_gmtutc,10)?"":"UTC/GMT "+h;0<a.organizers.length&&(l=a.organizers[0].name,
1<a.organizers.length&&(l+=" +"+(a.organizers.length-1)+" "+(1<a.organizers.length-1?k("morePlural"):k("moreSingular"))));0<a.products.length&&(n=a.products[0].title,1<a.products.length&&(n+=" +"+(a.products.length-1)+" "+(1<a.products.length-1?k("morePlural"):k("moreSingular"))));switch(a.icon_type){case "image":0<a.icon_images.length?(t.push('<div class="stec-layout-event-preview-left-icon-images">'),f.each(a.icon_images_meta,function(a){t.push('<div class="stec-layout-event-preview-left-icon-image '+
(0===a?"active":"")+'" style="background-image: url('+this.src+')"></div>')}),t.push("</div>")):t.push('<i class="'+a.icon+'"></i>');break;case "date":var m=p(a.start_date);t.push('<span class="stec-layout-event-preview-left-icon-date"><span class="stec-layout-event-preview-left-icon-date-number">'+m.format("D")+'</span><span class="stec-layout-event-preview-left-icon-date-month">'+k(m.format("MMM").toLowerCase())+"</span></span>");break;default:t.push('<i class="'+a.icon+'"></i>')}m=g.getPermalink(a.permalink,
a.repeat_time_offset);"external"===b.options.general_settings.open_event_in&&a.link&&(m=a.link.url);return d.replace(/#stec_replace_permalink/g,m).replace(/stec_replace_atarget/g,b.options.general_settings.event_open_target).replace("stec_replace_tags",e.join("")).replace("stec_replace_summary",a.title).replace("stec_replace_date",c+" "+h).replace("stec_replace_image",'style="background-image:url('+(0<a.images_meta.length?a.images_meta[0].src:"")+')"').replace('stec_replace_event_background=""','style="background:'+
a.color+'"').replace("stec_replace_organizer_image",'style="background-image: url('+(0<a.organizers.length&&a.organizers[0].photo_src?a.organizers[0].photo_src:"")+')"').replace("stec_replace_organizer_name",l).replace("stec_replace_product_name",n).replace("stec_replace_icon",t.join("")).replace("stec_replace_location",function(){return"virtual"===a.location.type?k("Online Event"):a.location.title?a.location.title:a.location.full_address}).replace("stec_replace_short_desc",a.description_short).replace(/#stec_replace_edit_link/g,
a.edit_link)}).appendTo(c.$grid.find(".stec-layout-grid-events"))}),a.resizeEvents(),g.extendBind("stachethemes_ec_extend","afterFillEvents"))})},calcColumns:function(){for(this.columns=this.options.defaultColumns;(c.$grid.find(".stec-layout-grid-events").width()-(this.columns-1)*this.options.gutter)/this.columns<this.options.blockMinWidth&&(this.columns--,1!==this.columns););},resizeEvents:function(){if(c.$grid.is(":visible")){var a=this;a.calcColumns();c.$grid.find(".stec-layout-grid-event").css({width:function(){var b=
(c.$grid.find(".stec-layout-grid-events").outerWidth()-(a.columns-1)*a.options.gutter)/a.columns;return Math.floor(b)}});this.positionEvents()}},positionEvents:function(){var a=this,b=0,e=0,h=0,g;c.$grid.find(".stec-layout-grid-event").each(function(d){var k=0,n=0;0<d&&0===d%a.columns&&(e++,h=0);0<h&&(g=f(this).prev(),k=g.outerWidth()+g.position().left+a.options.gutter);0<e&&(g=c.$grid.find(".stec-layout-grid-event").eq(d-a.columns),n=g.outerHeight()+g.position().top+a.options.gutter);f(this).css({top:n,
left:k});d=n+f(this).outerHeight()+a.options.gutter;b=Math.max(d,b);h++});c.$grid.find(".stec-layout-grid-events").height(b)}},boxgrid:{cache:{getNfutureEvents:!1},columns:0,options:{offset:0,perClick:4,blockMinWidth:270,defaultColumns:4,gutter:0},placeholders:{html:function(){var a=[];a.push('<div class="stec-layout-boxgrid-event-placeholder">');a.push("<span></span>");a.push("<span></span>");a.push("<span></span>");a.push("<span></span>");a.push("<div><span></span><span></span></div>");a.push("<div><span></span><span></span></div>");
a.push("</div>");return a.join("")},add:function(){var a,b=[];b.push('<div class="stec-layout-boxgrid-event-placeholders-wrap">');m.boxgrid.calcColumns();for(a=0;a<m.boxgrid.columns;a++)b.push(this.html());b.push("</div>");f(b.join("")).appendTo(c.$boxgrid.find(".stec-layout-boxgrid-events"))},remove:function(){c.$boxgrid.find(".stec-layout-boxgrid-events").children(".stec-layout-boxgrid-event-placeholders-wrap").remove()}},bindControls:function(){var a=this;this.options.defaultColumns=parseInt(b.options.general_settings.boxgrid_columns,
10);this.options.perClick=parseInt(b.options.general_settings.boxgrid_per_click,10);this.options.gutter=parseInt(b.options.general_settings.boxgrid_gutter,10);this.options.gutter||c.$boxgrid.find(".stec-layout-boxgrid-events-all-load-more").css({marginTop:10});c.$boxgrid.find(".stec-layout-boxgrid-events-all-load-more").on(g.clickHandle(),function(b){b.preventDefault();a.fill()});if("modal"===b.options.general_settings.open_event_in)c.$boxgrid.on(g.clickHandle(),".stec-layout-boxgrid-event",function(a){a.preventDefault();
v.eventToggle(f(this))});g.onResizeEnd(function(){a.resizeEvents()},50);c.on("onEventsLoaderShow",function(){"boxgrid"===b.options.view&&(m.boxgrid.placeholders.remove(),m.boxgrid.placeholders.add())});c.on("onEventsLoaderHide",function(){"boxgrid"===b.options.view&&m.boxgrid.placeholders.remove()})},set:function(){c.$boxgrid.show();this.clear();this.fill()},clear:function(){this.cache.getNfutureEvents=!1;c.$boxgrid.find(".stec-layout-boxgrid-events").empty();c.$boxgrid.find(".stec-layout-boxgrid-noevents").hide()},
getNfutureEvents:function(){var a=this;return new Promise(function(c){var d={events:[],loadMore:!1};if(a.cache.getNfutureEvents){var h=a.getNfutureEvents.i++*a.getNfutureEvents.n;var g=h+a.getNfutureEvents.n;d.events=a.cache.getNfutureEvents.slice(h,g);d.loadMore=0<a.cache.getNfutureEvents.slice(g,g+1).length?!0:!1;return c(d)}a.getNfutureEvents.n=a.options.perClick;r.getFutureEventsThread(!0,"getFutureEventsThread").then(function(e){1===parseInt(b.options.general_settings.reverse_agenda_list,10)?
a.cache.getNfutureEvents=f(e).get().reverse():a.cache.getNfutureEvents=e;a.getNfutureEvents.i=0;h=a.getNfutureEvents.i++*a.getNfutureEvents.n;g=h+a.getNfutureEvents.n;d.events=a.cache.getNfutureEvents.slice(h,g);d.loadMore=0<a.cache.getNfutureEvents.slice(g,g+1).length?!0:!1;return c(d)})})},fill:function(){var a=this;z.show();this.getNfutureEvents().then(function(d){var e=d.events;d=d.loadMore;z.hide();!e||0>=e.length?(c.$boxgrid.find(".stec-layout-boxgrid-events-all-control").hide(),0>=c.$boxgrid.find(".stec-layout-boxgrid-events").children().length&&
c.$boxgrid.find(".stec-layout-boxgrid-noevents").show()):(!1===d?c.$boxgrid.find(".stec-layout-boxgrid-events-all-control").hide():c.$boxgrid.find(".stec-layout-boxgrid-events-all-control").show(),f(e).each(function(){var a=this,d=[],e=[],l=!1,m=g.getEventState(this);(0<m||"EventCancelled"===a.event_status||"0"===b.options.general_settings.reminder)&&d.push("stec-layout-event-no-reminder");switch(parseInt(this.featured,10)){case 1:d.push("stec-event-featured");break;case 2:d.push("stec-event-featured stec-event-featured-bg")}("icon"!==
a.icon_type||a.icon&&"fa"!==a.icon)&&"date"!==a.icon_type||d.push("stec-no-icon");0<a.images_meta.length&&d.push("stec-has-image");switch(a.event_status){case "EventCancelled":e.push('<span class="cancelled">'+k("Cancelled")+"</span>");break;case "EventMovedOnline":e.push('<span class="moved-online">'+k("Moved Online")+"</span>");break;case "EventPostponed":e.push('<span class="postponed">'+k("Postponed")+"</span>");break;case "EventRescheduled":e.push('<span class="rescheduled">'+k("Rescheduled")+
"</span>")}0===a.approved&&e.push('<span class="unapproved">'+k("Awaiting Approval")+"</span>");0<a.featured&&e.push('<span class="stec-featured-tag">'+k("featured")+"</span>");f.each(a.category,function(){e.push('<span style="background-color:'+this.color+'">'+this.title+"</span>")});0<e.length&&d.push("stec-has-tags");isNaN(b.options.userid)||f(a.attendance).each(function(){if(this.userid===b.options.userid)return l=!0,!1});l&&d.push("stec-user-invited");2===m?d.push("stec-expired"):1===m&&d.push("stec-in-progress");
"EventCancelled"===a.event_status&&d.push("stec-event-cancelled");f(b.template.boxgridevent).addClass(d.join(" ")).attr({"data-id":a.id,"data-repeat-time-offset":a.repeat_time_offset?a.repeat_time_offset:0}).html(function(c,d){var h="";var l=[],n="";c=g.beautifyTimespan(a.start_date,1===parseInt(a.hide_end,10)?!1:a.end_date,a.all_day);var m=parseInt(a.timezone_utc_offset,10)/3600;m=0<m?"+"+m:m;0===m&&(m="");m=0===parseInt(b.options.general_settings.date_label_gmtutc,10)?"":"UTC/GMT "+m;var t="<span>"+
p(a.start_date).format("D")+"</span> "+k(p(a.start_date).format("MMM").toLowerCase());h="<span>"+p(a.end_date).format("D")+"</span> "+k(p(a.end_date).format("MMM").toLowerCase());t=t+" "+(t!==h?" - "+h:"");0<a.products.length&&(h=a.products[0].title,1<a.products.length&&(h+=" +"+(a.products.length-1)+" "+(1<a.products.length-1?k("morePlural"):k("moreSingular"))));switch(a.icon_type){case "image":0<a.icon_images.length?(l.push('<div class="stec-layout-event-preview-left-icon-images">'),f.each(a.icon_images_meta,
function(a){l.push('<div class="stec-layout-event-preview-left-icon-image '+(0===a?"active":"")+'" style="background-image: url('+this.src+')"></div>')}),l.push("</div>")):l.push('<i class="'+a.icon+'"></i>');break;case "date":h=p(a.start_date);l.push('<span class="stec-layout-event-preview-left-icon-date"><span class="stec-layout-event-preview-left-icon-date-number">'+h.format("D")+'</span><span class="stec-layout-event-preview-left-icon-date-month">'+k(h.format("MMM").toLowerCase())+"</span></span>");
break;default:l.push('<i class="'+a.icon+'"></i>')}0<a.images.length&&f.each(a.images_meta,function(a){n+='<div class="stec-layout-boxgrid-image '+(0===a?"active":"")+'" style="background-image: url('+this.src+')"></div>'});h=g.getPermalink(a.permalink,a.repeat_time_offset);"external"===b.options.general_settings.open_event_in&&a.link&&(h=a.link.url);return d.replace(/#stec_replace_permalink/g,h).replace(/stec_replace_atarget/g,b.options.general_settings.event_open_target).replace("stec_replace_tags",
e.join("")).replace("stec_replace_summary",a.title).replace("stec_replace_date_big",t).replace("stec_replace_date",c+" "+m).replace("stec_replace_image",n).replace('stec_replace_event_background=""','style="background:'+a.color+'"').replace("stec_replace_icon",l.join("")).replace("stec_replace_short_desc",a.description_short)}).appendTo(c.$boxgrid.find(".stec-layout-boxgrid-events"))}),g.extendBind("stachethemes_ec_extend","afterFillEvents"),a.resizeEvents())})},resizeEvents:function(){if(c.$boxgrid.is(":visible")){var a=
this;var b=c.$boxgrid.find(".stec-layout-boxgrid-event");var e=a.options.gutter?!0:!1;a.calcColumns();e&&b.css({marginRight:0,marginBottom:a.options.gutter});b.css({width:function(){var b=(Math.floor(g.getElementWidth(c.$boxgrid.find(".stec-layout-boxgrid-events")))-(a.columns-1)*a.options.gutter)/a.columns;return Math.floor(b)}});e&&b.filter(":not(:nth-child("+a.columns+"n))").css({marginRight:a.options.gutter})}},calcColumns:function(){var a=Math.floor(g.getElementWidth(c.$boxgrid.find(".stec-layout-boxgrid-events")));
for(this.columns=this.options.defaultColumns;(a-(this.columns-1)*this.options.gutter)/this.columns<this.options.blockMinWidth&&(this.columns--,1!==this.columns););}},map:{bindControls:function(){},set:function(){c.$map.show();!1===m.map.sidebar.hasSidebar()&&c.$map.find(".stec-layout-map-container").width("100%");switch(b.options.general_settings.map_type){case "gmap":this.gmap.set();break;case "osm":this.osm.set()}this.sidebar.set()},getRanges:function(){function a(){let a,c;var d=b.options.day;
a=b.options.month;c=b.options.year;var e=p();e.set("year",c);e.set("month",a);e.set("date",d);e.set("hour",0);e.set("minute",0);e.set("second",0);d=e.startOf("month").toDate();e=e.endOf("month").toDate();return[d,e]}var d=[];if(b.options.map_date_start&&b.options.map_date_end){d=p(b.options.map_date_start);var e=p(b.options.map_date_end);!1===d.isValid()||!1===e.isValid()?d=a():(d=[d.toDate(),e.toDate()],c.$top.find(".stec-top-menu-date-month").hide(),c.$top.find(".stec-top-menu-date-year").hide(),
c.$top.find("[data-action='previous']").hide(),c.$top.find("[data-action='next']").hide())}else d=a();return d},getEventsWithPhysicalLocations:function(a){var b=[];f.each(a,function(){this.location.id&&"virtual"!==this.location.type&&b.push(this)});return b},getMarkerHtml:function(a){var c=[],e=g.beautifyTimespan(a.start_date,a.end_date,a.all_day);c.push('<div style="box-sizing: border-box; max-width:270px; padding:10px;">');c.push("<h3>"+a.title+"</h3>");c.push('<p style="margin-top:5px;">'+e+"</p>");
a.location.full_address&&c.push('<p style="margin-top:5px;">'+a.location.full_address+"</p>");c.push('<p style="margin-top:5px;">'+a.description_short+"</p>");!1===m.map.sidebar.hasSidebar()&&c.push('<a class="stec-style-button" target="'+(b.options.general_settings.event_open_target?b.options.general_settings.event_open_target:"_blank")+'" href="'+g.getPermalink(a.permalink,a.repeat_time_offset)+'" style="margin-top:10px; display: block;">'+k("View Event")+"</a>");c.push("</div>");return c.join("")},
gmap:{zoom:8,gmap:null,geocoder:null,container:null,location:[0,0],markers:[],activeInfoWindow:null,canvasImage:function(a,b,c,h,f){var d=document.createElement("canvas");d.width=a;d.height=b;var e=d.getContext("2d");e.beginPath();e.beginPath();e.moveTo(4,0);e.lineTo(0+a-4,0);e.quadraticCurveTo(0+a,0,0+a,4);e.lineTo(0+a,0+b-4);e.quadraticCurveTo(0+a,0+b,0+a-4,0+b);e.lineTo(4,0+b);e.quadraticCurveTo(0,0+b,0,0+b-4);e.lineTo(0,4);e.quadraticCurveTo(0,0,4,0);e.fill();e.fillStyle=c;e.fill();e.lineWidth=
f;e.strokeStyle=h;e.stroke();return d.toDataURL()},set:function(){null===this.gmap?(this.zoom=b.options.map_zoom?parseInt(b.options.map_zoom,10):this.zoom,this.container=c.$map.find(".stec-layout-map-container").get(0),this.gmap=new window.google.maps.Map(this.container,{zoom:this.zoom,mapTypeControlOptions:{mapTypeIds:[]}}),b.options.gmap_theme&&"standard"!==b.options.gmap_theme&&(this.gmap.mapTypes.set("Custom_Style",g.getMapStyles(b.options.gmap_theme)),this.gmap.setMapTypeId("Custom_Style")),
this.geocoder=new window.google.maps.Geocoder,b.options.map_focus?this.focusLocation(b.options.map_focus):this.focusLocation(null,this.location)):this.refresh(!0);this.drawActiveMarkers()},clearMarkers:function(){var a;for(a=0;a<this.markers.length;a++)this.markers[a].setMap(null)},drawActiveMarkers:function(){var a=this,c=m.map.getRanges();this.clearMarkers();r.getNearestDateEventsThread(c[0],c[1],!0,"drawActiveMarkers").then(function(c){c=m.map.getEventsWithPhysicalLocations(c);var d=!1;0>=c.length?
m.map.sidebar.noEventsDisplay():(f.each(c,function(){let c=this,e;!1===d&&(b.options.map_focus||(c.location.coordinates?(a.location=c.location.coordinates.split(","),a.focusLocation(null,a.location)):a.focusLocation(c.location.full_address)),d=!0);e=c.location.full_address;c.location.coordinates?a.addMarker(c):a.getCoordinates(e,function(b){!1!==b&&(c.location.coordinates=b.toString().replace(/\(|\)/gi,""),a.addMarker(c))})}),m.map.sidebar.listEvents(c));g.extendBind("stachethemes_ec_extend","afterFillEvents")})},
addMarker:function(a){var d=this,e=a.location.coordinates.split(",").map(function(a){return Number(a)});e={lat:e[0],lng:e[1]};b.temp.stecMapMarkerIcon=d.canvasImage(50,50,a.color,"white",4);b.temp.stecMapPopupHtml=m.map.getMarkerHtml(a);c.trigger("stecMapMarkerIcon",{$instance:c,event:a,temp:b.temp});var h=new window.google.maps.Marker({position:e,map:d.gmap,icon:b.temp.stecMapMarkerIcon,title:a.title,zIndex:1E3,stec:{event:a}});var f=new window.google.maps.InfoWindow({content:b.temp.stecMapPopupHtml});
h.addListener("click",function(){d.activeInfoWindow&&d.activeInfoWindow.close();f.open(d.gmap.gmap,h);m.map.sidebar.hasSidebar()&&m.map.sidebar.focusEvent(this.stec.event);d.activeInfoWindow=f});window.google.maps.event.addListener(f,"closeclick",function(){m.map.sidebar.clearFocus();m.map.sidebar.isSmallScreen()&&m.map.sidebar.scroller.doScroll()});d.markers.push(h)},getCoordinates:function(a,b){var c=this;c.geocoder.geocode({address:a},function(d,e){var f=!1;e===window.google.maps.GeocoderStatus.OK?
(f=d[0].geometry.location,"function"===typeof b&&b(f)):"OVER_QUERY_LIMIT"===e?setTimeout(function(){c.getCoordinates(a,b)},3E3):(console.log("Geocoder error: "+e),"function"===typeof b&&b(!1))})},focusLocation:function(a,b){var c=this;!a&&b?c.gmap.setCenter(new window.google.maps.LatLng(b[0],b[1])):(a||(a=c.location),c.geocoder.geocode({address:a},function(a,b){b===window.google.maps.GeocoderStatus.OK?c.gmap.setCenter(a[0].geometry.location):console.log("Geocoder error: "+b)}));c.refresh()},refresh:function(a){var c=
this;setTimeout(function(){window.google.maps.event.trigger(c.container,"resize");b.options.map_focus||!0!==a||c.focusLocation(null,c.location)},10)}},osm:{zoom:8,omap:null,container:null,location:[0,0],markers:[],markersLayer:null,infoWindow:null,set:function(){var a=this;null===a.omap&&(a.zoom=b.options.map_zoom?parseInt(b.options.map_zoom,10):a.zoom,a.container=c.$map.find(".stec-layout-map-container").get(0),a.omap=g.osm(a.container),b.options.map_focus?null===b.options.map_focus.match(/[aA-zZ]+/)?
(a.location=b.options.map_focus.split(","),a.omap.setView(a.location,a.zoom),b.options.map_focus=null):g.promiseGetAddressCoordinates(b.options.map_focus).then(function(c){a.location=c.split(",");a.omap.setView(a.location,a.zoom);b.options.map_focus=null}).catch(function(){a.omap.setView(a.location,a.zoom)}):a.omap.setView(a.location,a.zoom));a.drawActiveMarkers()},clearMarkers:function(){this.markersLayer&&(this.omap.removeLayer(this.markersLayer),this.markersLayer=null,this.markers=[])},drawActiveMarkers:function(){var a=
this,c=m.map.getRanges(),e=0;a.clearMarkers();r.getNearestDateEventsThread(c[0],c[1],!0,"drawActiveMarkers").then(function(c){var d=[];c=m.map.getEventsWithPhysicalLocations(c);var h=c.length;0>=h?(m.map.sidebar.noEventsDisplay(),g.extendBind("stachethemes_ec_extend","afterFillEvents")):(f.each(c,function(){let c=this;g.promiseCoordinates(c).then(function(b){c.location.coordinates=b;a.addMarker(c);d.push(c)}).finally(function(){e++;e===h&&(b.options.map_focus||(a.location=d[0].location.coordinates.split(","),
a.omap.setView(a.location,a.zoom)),a.markersLayer=window.L.layerGroup(a.markers),a.omap.addLayer(a.markersLayer),g.extendBind("stachethemes_ec_extend","afterFillEvents"))})}),m.map.sidebar.listEvents(c))})},addMarker:function(a){var d=[],e=a.location.coordinates.split(",").map(function(a){return Number(a)});switch(a.icon_type){case "image":0<a.icon_images.length?d.push("<div style='background-image: url("+a.icon_images_meta[0].thumb+")'></div>"):d.push("<div style='background-color:"+a.color+"'><i class='"+
a.icon+"'></i></div>");break;case "date":var f=p(a.start_date);d.push("<div style='background-color:"+a.color+"'><span class='icon-date'>"+f.format("D")+"</span> <span class='icon-month'>"+k(f.format("MMM").toLowerCase())+"</span></div>");break;default:d.push("<div style='background-color:"+a.color+"'><i class='"+a.icon+"'></i></div>")}b.temp.stecMapMarkerIcon=new window.L.divIcon({className:"stec-omap-marker-pin",html:d.join(""),iconSize:[54,54],iconAnchor:[22,22]});b.temp.stecMapPopupHtml=m.map.getMarkerHtml(a);
c.trigger("stecMapMarkerIcon",{$instance:c,event:a,temp:b.temp});c.trigger("stecMapPopup",{$instance:c,event:a,temp:b.temp});f=window.L.marker(e,{icon:b.temp.stecMapMarkerIcon,riseOnHover:!0});f.bindPopup(b.temp.stecMapPopupHtml);f.on("click",function(){m.map.sidebar.hasSidebar()&&m.map.sidebar.focusEvent(a)});f.getPopup().on("remove",function(){m.map.sidebar.hasSidebar()&&(m.map.sidebar.clearFocus(),m.map.sidebar.isSmallScreen()&&m.map.sidebar.scroller.doScroll())});this.markers.push(f)}},sidebar:{isSidebarEnabled:null,
maxHeight:600,hasSidebar:function(){null===this.isSidebarEnabled&&(this.isSidebarEnabled=!(b.options.map_list&&0===parseInt(b.options.map_list,10)));return this.isSidebarEnabled},set:function(){!1===this.hasSidebar()?c.$map.find(".stec-layout-map-sidebar").hide():(c.$map.removeClass("sidebar-fullwidth"),v.eventHolder.close(),this.clearFocus(),c.$map.find(".stec-layout-map-sidebar .stec-scrollable").css("max-height",this.maxHeight))},isSmallScreen:function(){return g.isMobile()||c.hasClass("stec-media-small")||
c.hasClass("stec-media-med")},scroller:{doScroll:function(){if(c.$map.find(".stec-scrollable").data("stec-scroll")){var a=c.$map.find(".stec-scrollable").data("stec-scroll");a.reset()}else a=new window.StecScroll,a.create(c.$map.find(".stec-scrollable")),c.$map.find(".stec-scrollable").data("stec-scroll",a);return a},removeScroller:function(){var a=c.$map.find(".stec-scrollable").data("stec-scroll");a&&(a.destroy(),c.$map.find(".stec-scrollable").data("stec-scroll",null))},scrollTo:function(a){var b=
c.$map.find(".stec-scrollable").data("stec-scroll");b&&b.outer&&b.scrollTo(a)}},clearFocus:function(){var a=c.$map.find(".stec-layout-events"),b=a.find(".stec-layout-event");a.removeClass("container-focused");b.removeClass("event-focused")},focusLocation:function(a){if("1"!==b.options.map_list_nofocus)switch(b.options.general_settings.map_type){case "gmap":m.map.gmap.gmap.panTo(new window.google.maps.LatLng(a[0],a[1]));break;case "osm":m.map.osm.omap.setView(a,m.map.osm.zoom)}},focusEvent:function(a){var b=
a.id,e=a.repeat_time_offset?a.repeat_time_offset:0;a=c.$map.find(".stec-layout-events");b=a.find('.stec-layout-event[data-id="'+b+'"][data-repeat-time-offset="'+e+'"]');g.isMobile()||(this.scroller.scrollTo(-1*b.position().top),this.clearFocus());a.addClass("container-focused");b.addClass("event-focused");this.isSmallScreen()&&this.scroller.removeScroller()},noEventsDisplay:function(){this.scroller.removeScroller();c.$map.find(".stec-layout-map-noevents").show()},listEvents:function(a){a?(c.$map.find(".stec-layout-map-noevents").hide(),
v.eventHolder.openEvents(a,function(){m.map.sidebar.scroller.doScroll()},!0)):this.noEventsDisplay()},bindControls:function(){g.onResizeEnd(function(){c.$map.is(":visible")&&(m.map.sidebar.scroller.doScroll(),m.map.sidebar.scroller.scrollTo(0))},50);c.on("onEventToggleOpen",function(a,d){"self"===b.options.general_settings.open_event_in&&(!1===d.$container.parent().hasClass("event-focused")&&m.map.sidebar.clearFocus(),c.$map.addClass("sidebar-fullwidth"),m.map.sidebar.scroller.removeScroller(),c.$map.find(".stec-layout-map-sidebar .stec-scrollable").css("max-height",
"none"))});c.on("onEventToggleClose",function(){"self"===b.options.general_settings.open_event_in&&(c.$map.removeClass("sidebar-fullwidth"),c.$map.find(".stec-layout-map-sidebar .stec-scrollable").css("max-height",m.map.sidebar.maxHeight),m.map.sidebar.scroller.doScroll())});c.$map.find(".stec-layout-events").on("mouseenter",".stec-layout-event",function(){if(!c.$map.find(".stec-layout-events").hasClass("container-focused")){var a=f(this).data("id");a=r.getEventById(a);a.location&&a.location.coordinates&&
m.map.sidebar.focusLocation(a.location.coordinates.split(","))}})}}},bindControls:function(){setInterval(function(){c.find(".stec-layout-event-preview-left-icon-images").filter(":visible").each(function(){if(!(1>=f(this).children().length)){var a=f(this).children().filter(".active");var b=a.next();0===b.length&&(b=f(this).children().first());b.addClass("transition");setTimeout(function(){a.removeClass("active");b.removeClass("transition").addClass("active")},1E3)}})},6E3);setInterval(function(){c.$boxgrid.find(".stec-layout-boxgrid-images").filter(":visible").each(function(){if(!(1>=
f(this).children().length)){var a=f(this).children().filter(".active");var b=a.next();0===b.length&&(b=f(this).children().first());b.addClass("transition");setTimeout(function(){a.removeClass("active");b.removeClass("transition").addClass("active")},1E3)}})},6E3)}};this.refreshState=function(a){switch(a){case "layout":m.set();break;case "top":y.set();break;default:m.set()}};this.prepareEvents=function(a){if(window.stecJsonEvents&&window.stecJsonEvents[b.options.id]){var c=new window.Promise(function(a,
c){r.addToEventsPool(window.stecJsonEvents[b.options.id]);setTimeout(function(){a()})});c.then(function(){"function"===typeof a&&a()})}else G.add(),r.queryEvents(a,function(){G.count(r.eventsPool.length)})};this.init=function(a){var d=new Date;B=new window.StecDB;g=new window.StecHelper;r=new window.StecCalData;f.extend(b.options,a);x="#"+b.options.id;c=f(x);g.set("glob",b).set("calData",r).set("$instance",c).set("instance",x).set("layout",m).set("eventsHandler",v);r.set("helper",g).set("glob",b).set("DB",
B);"0"!==b.options.general_settings.reminder&&(D=new window.StecReminder("reminder-popup-id-"+b.options.id),D.set("$instance",c).set("instance",x).set("helper",g).set("calData",r).set("displayPrivacyAgreement",b.options.general_settings.display_privacy_agreement).set("privacyAgreemntContent",b.options.general_settings.privacy_agreement_content).set("glob",b),D.controller());C=new window.StecRsvpToEvent("rsvp-popup-id-"+b.options.id);C.set("$instance",c).set("helper",g).set("calData",r).set("layout",
m).set("displayPrivacyAgreement",b.options.general_settings.display_privacy_agreement).set("privacyAgreemntContent",b.options.general_settings.privacy_agreement_content).set("glob",b);C.controller();b.rsvp=C;window.StecBooking&&(E=new window.StecBooking("booking-popup-id-"+b.options.id),E.set("$instance",c).set("helper",g).set("glob",b),E.controller());window.StecShop&&(F=new window.StecShop,F.set("$instance",c).set("helper",g).set("glob",b),F.controller());if(0>=c.length)console.log("Stachethemes Event Calendar - License is not activated");
else{g.isMobile()&&c.addClass("stec-mobile");c.$top=c.children(".stec-top");c.$agenda=c.children(".stec-layout").find(".stec-layout-agenda");c.$month=c.children(".stec-layout").find(".stec-layout-month");c.$week=c.children(".stec-layout").find(".stec-layout-week");c.$day=c.children(".stec-layout").find(".stec-layout-day");c.$grid=c.children(".stec-layout").find(".stec-layout-grid");c.$boxgrid=c.children(".stec-layout").find(".stec-layout-boxgrid");c.$map=c.children(".stec-layout").find(".stec-layout-map");
c.$events=c.children(".stec-layout").find(".stec-layout-events");c.$top.path=x+" .stec-top ";c.$agenda.path=x+" .stec-layout .stec-layout-agenda ";c.$month.path=x+" .stec-layout .stec-layout-month ";c.$week.path=x+" .stec-layout .stec-layout-week ";c.$day.path=x+" .stec-layout .stec-layout-day ";c.$events.path=x+" .stec-layout-events ";b.template.eventCreateForm=f("#stec-event-create-form-template").html();b.template.event=f("#stec-event-template").html();b.template.gridevent=f("#stec-grid-event-template").html();
b.template.boxgridevent=f("#stec-boxgrid-event-template").html();b.template.eventInner=f("#stec-event-inner-template").html();b.template.tooltip=f("#stec-tooltip-template").html();b.template.preloader=f("#stec-preloader-template").html();b.template.share=f("#stec-share-template").html();b.template.emailEvent=f("#stec-email-event-template").html();b.options.view=b.options.general_settings.view;if("undefined"!==typeof b.options.start_date)switch(b.options.start_date){case "prev_week":d=p().subtract(1,
"week").startOf("week").toDate();break;case "prev_month":d=p().subtract(1,"month").startOf("month").toDate();break;case "this_week":d=p().startOf("week").toDate();break;case "next_week":d=p().add(1,"week").startOf("week").toDate();break;case "next_month":d=p().add(1,"month").startOf("month").toDate();break;case "this_month":d=p().startOf("month").toDate();break;default:if(a=b.options.start_date.match(/(\+|\-)(\d)M/),null!==a)switch(a[1]){case "+":d=p().add(parseInt(a[2],10),"month").startOf("month").toDate();
break;case "-":d=p().subtract(parseInt(a[2],10),"month").startOf("month").toDate()}else d=new Date(b.options.start_date)}if(b.options.min_date)switch(b.options.min_date){case "this_week":var e=g.getWeekInfo(p().toDate());a=e.start.month+1;a=parseInt(("0"+a).slice(-2),10);b.options.min_date=e.start.year+"-"+a+"-"+e.start.day;break;case "prev_week":e=g.getWeekInfo(p().subtract(1,"week").toDate());a=e.start.month+1;a=parseInt(("0"+a).slice(-2),10);b.options.min_date=e.start.year+"-"+a+"-"+e.start.day;
break;case "next_week":e=g.getWeekInfo(p().add(1,"week").toDate());a=e.start.month+1;a=parseInt(("0"+a).slice(-2),10);b.options.min_date=e.start.year+"-"+a+"-"+e.start.day;break;case "prev_month":a=p().subtract(1,"month").startOf("month");b.options.min_date=a.format("YYYY-MM-DD");break;case "next_month":a=p().add(1,"month").startOf("month");b.options.min_date=a.format("YYYY-MM-DD");break;case "this_month":a=p().startOf("month");b.options.min_date=a.format("YYYY-MM-DD");break;case "today":a=p().startOf("day");
b.options.min_date=a.format("YYYY-MM-DD");break;default:if(a=b.options.min_date.match(/(\+|\-)(\d)M/),null!==a)switch(a[1]){case "+":b.options.min_date=p().add(parseInt(a[2],10),"month").startOf("month").format("YYYY-MM-DD");break;case "-":b.options.min_date=p().subtract(parseInt(a[2],10),"month").startOf("month").format("YYYY-MM-DD")}}if(b.options.max_date)switch(b.options.max_date){case "this_week":e=g.getWeekInfo(p().toDate());a=e.start.month+1;a=parseInt(("0"+a).slice(-2),10);b.options.max_date=
e.end.year+"-"+a+"-"+e.end.day;break;case "prev_week":e=g.getWeekInfo(p().subtract(1,"week").toDate());a=e.end.month+1;a=parseInt(("0"+a).slice(-2),10);b.options.max_date=e.end.year+"-"+a+"-"+e.end.day;break;case "next_week":e=g.getWeekInfo(p().add(1,"week").toDate());a=e.end.month+1;a=parseInt(("0"+a).slice(-2),10);b.options.max_date=e.end.year+"-"+a+"-"+e.end.day;break;case "prev_month":a=p().subtract(1,"month").endOf("month");b.options.max_date=a.format("YYYY-MM-DD");break;case "next_month":a=
p().add(1,"month").endOf("month");b.options.max_date=a.format("YYYY-MM-DD");break;case "this_month":a=p().endOf("month");b.options.max_date=a.format("YYYY-MM-DD");break;case "today":a=p().endOf("day");b.options.max_date=a.format("YYYY-MM-DD");break;default:if(a=b.options.max_date.match(/(\+|\-)(\d)M/),null!==a)switch(a[1]){case "+":b.options.max_date=p().add(parseInt(a[2],10),"month").endOf("month").format("YYYY-MM-DD");break;case "-":b.options.max_date=p().subtract(parseInt(a[2],10),"month").endOf("month").format("YYYY-MM-DD")}}b.options.day=
d.getDate();b.options.month=d.getMonth();b.options.year=d.getFullYear();"undefined"!==typeof window.StecAnimate&&g.set("animate",new window.StecAnimate(c));y.init();m.init();v.init();this.prepareEvents(function(){G.destroy();c.show();u.refreshState("layout")});g.extendBind("stachethemes_ec_extend")}};p.locale("en")}f(function(){"function"===typeof f.fn.datepicker.noConflict&&(f.fn.bootstrapDP=f.fn.datepicker.noConflict());f(document).on("click",".stec-fixed-message a",function(k){k.preventDefault();
f(this).parents(".stec-fixed-message").remove()});"undefined"!==typeof window.stecInstance&&f(window.stecInstance).each(function(){var k=this;if(this.init_on_trigger)f(document).on(this.init_on_trigger,function(){f(document).trigger("stecInitOnTrigger",k);u=new B;u.init(k)});else{var u=new B;u.init(k)}})});window.StachethemesEventCalendar=B})(window.jQuery);